var Hn=r=>{throw TypeError(r)};var vr=(r,e,t)=>e.has(r)||Hn("Cannot "+t);var y=(r,e,t)=>(vr(r,e,"read from private field"),t?t.call(r):e.get(r)),B=(r,e,t)=>e.has(r)?Hn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),R=(r,e,t,s)=>(vr(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),J=(r,e,t)=>(vr(r,e,"access private method"),t);var Is=(r,e,t,s)=>({set _(n){R(r,e,n,t)},get _(){return y(r,e,s)}});import{j as o,c as cl,a as Xs,u as Ds,B as dl,P as Pe,V as Ji,b as mn,d as yn,e as Ws,f as ge,R as ul,g as hl,h as fl,i as gl,k as Yi,A as pl,D as ml,C as yl,l as vl,m as bl,n as wl,o as xl,p as _l,S as kl,O as Xi,q as Zi,r as Sl,T as ea,s as ta,t as jl,v as El,w as sa,I as Cl,x as ra,y as na,z as Tl,E as ia,F as Nl,L as aa,G as oa,H as Dl,J as Ol,K as la,M as Al,N as Pl,Q as Rl,U as Il}from"./ui-Csu4WP-_.js";import{a as ca,r as g,d as _e,g as Zs,e as $l}from"./vendor-DYACTBzZ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var da,Gn=ca;da=Gn.createRoot,Gn.hydrateRoot;var Os=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ot=typeof window>"u"||"Deno"in globalThis;function Ae(){}function Ml(r,e){return typeof r=="function"?r(e):r}function $r(r){return typeof r=="number"&&r>=0&&r!==1/0}function ua(r,e){return Math.max(r+(e||0)-Date.now(),0)}function Wt(r,e){return typeof r=="function"?r(e):r}function Fe(r,e){return typeof r=="function"?r(e):r}function Qn(r,e){const{type:t="all",exact:s,fetchStatus:n,predicate:i,queryKey:a,stale:l}=r;if(a){if(s){if(e.queryHash!==vn(a,e.options))return!1}else if(!ks(e.queryKey,a))return!1}if(t!=="all"){const c=e.isActive();if(t==="active"&&!c||t==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||n&&n!==e.state.fetchStatus||i&&!i(e))}function Jn(r,e){const{exact:t,status:s,predicate:n,mutationKey:i}=r;if(i){if(!e.options.mutationKey)return!1;if(t){if(_s(e.options.mutationKey)!==_s(i))return!1}else if(!ks(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||n&&!n(e))}function vn(r,e){return((e==null?void 0:e.queryKeyHashFn)||_s)(r)}function _s(r){return JSON.stringify(r,(e,t)=>Lr(t)?Object.keys(t).sort().reduce((s,n)=>(s[n]=t[n],s),{}):t)}function ks(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!ks(r[t],e[t])):!1}function ha(r,e){if(r===e)return r;const t=Yn(r)&&Yn(e);if(t||Lr(r)&&Lr(e)){const s=t?r:Object.keys(r),n=s.length,i=t?e:Object.keys(e),a=i.length,l=t?[]:{};let c=0;for(let d=0;d<a;d++){const u=t?d:i[d];(!t&&s.includes(u)||t)&&r[u]===void 0&&e[u]===void 0?(l[u]=void 0,c++):(l[u]=ha(r[u],e[u]),l[u]===r[u]&&r[u]!==void 0&&c++)}return n===a&&c===n?r:l}return e}function Mr(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function Yn(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Lr(r){if(!Xn(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!Xn(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function Xn(r){return Object.prototype.toString.call(r)==="[object Object]"}function Ll(r){return new Promise(e=>{setTimeout(e,r)})}function Ur(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?ha(r,e):e}function Ul(r,e,t=0){const s=[...r,e];return t&&s.length>t?s.slice(1):s}function Fl(r,e,t=0){const s=[e,...r];return t&&s.length>t?s.slice(0,-1):s}var bn=Symbol();function fa(r,e){return!r.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!r.queryFn||r.queryFn===bn?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var kt,ot,Gt,Bi,Bl=(Bi=class extends Os{constructor(){super();B(this,kt);B(this,ot);B(this,Gt);R(this,Gt,e=>{if(!Ot&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){y(this,ot)||this.setEventListener(y(this,Gt))}onUnsubscribe(){var e;this.hasListeners()||((e=y(this,ot))==null||e.call(this),R(this,ot,void 0))}setEventListener(e){var t;R(this,Gt,e),(t=y(this,ot))==null||t.call(this),R(this,ot,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){y(this,kt)!==e&&(R(this,kt,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof y(this,kt)=="boolean"?y(this,kt):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},kt=new WeakMap,ot=new WeakMap,Gt=new WeakMap,Bi),wn=new Bl,Qt,lt,Jt,qi,ql=(qi=class extends Os{constructor(){super();B(this,Qt,!0);B(this,lt);B(this,Jt);R(this,Jt,e=>{if(!Ot&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){y(this,lt)||this.setEventListener(y(this,Jt))}onUnsubscribe(){var e;this.hasListeners()||((e=y(this,lt))==null||e.call(this),R(this,lt,void 0))}setEventListener(e){var t;R(this,Jt,e),(t=y(this,lt))==null||t.call(this),R(this,lt,e(this.setOnline.bind(this)))}setOnline(e){y(this,Qt)!==e&&(R(this,Qt,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return y(this,Qt)}},Qt=new WeakMap,lt=new WeakMap,Jt=new WeakMap,qi),Vs=new ql;function Fr(){let r,e;const t=new Promise((n,i)=>{r=n,e=i});t.status="pending",t.catch(()=>{});function s(n){Object.assign(t,n),delete t.resolve,delete t.reject}return t.resolve=n=>{s({status:"fulfilled",value:n}),r(n)},t.reject=n=>{s({status:"rejected",reason:n}),e(n)},t}function Kl(r){return Math.min(1e3*2**r,3e4)}function ga(r){return(r??"online")==="online"?Vs.isOnline():!0}var pa=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function br(r){return r instanceof pa}function ma(r){let e=!1,t=0,s=!1,n;const i=Fr(),a=v=>{var m;s||(f(new pa(v)),(m=r.abort)==null||m.call(r))},l=()=>{e=!0},c=()=>{e=!1},d=()=>wn.isFocused()&&(r.networkMode==="always"||Vs.isOnline())&&r.canRun(),u=()=>ga(r.networkMode)&&r.canRun(),h=v=>{var m;s||(s=!0,(m=r.onSuccess)==null||m.call(r,v),n==null||n(),i.resolve(v))},f=v=>{var m;s||(s=!0,(m=r.onError)==null||m.call(r,v),n==null||n(),i.reject(v))},p=()=>new Promise(v=>{var m;n=x=>{(s||d())&&v(x)},(m=r.onPause)==null||m.call(r)}).then(()=>{var v;n=void 0,s||(v=r.onContinue)==null||v.call(r)}),b=()=>{if(s)return;let v;const m=t===0?r.initialPromise:void 0;try{v=m??r.fn()}catch(x){v=Promise.reject(x)}Promise.resolve(v).then(h).catch(x=>{var C;if(s)return;const _=r.retry??(Ot?0:3),w=r.retryDelay??Kl,k=typeof w=="function"?w(t,x):w,A=_===!0||typeof _=="number"&&t<_||typeof _=="function"&&_(t,x);if(e||!A){f(x);return}t++,(C=r.onFail)==null||C.call(r,t,x),Ll(k).then(()=>d()?void 0:p()).then(()=>{e?f(x):b()})})};return{promise:i,cancel:a,continue:()=>(n==null||n(),i),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?b():p().then(b),i)}}function zl(){let r=[],e=0,t=l=>{l()},s=l=>{l()},n=l=>setTimeout(l,0);const i=l=>{e?r.push(l):n(()=>{t(l)})},a=()=>{const l=r;r=[],l.length&&n(()=>{s(()=>{l.forEach(c=>{t(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||a()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{t=l},setBatchNotifyFunction:l=>{s=l},setScheduler:l=>{n=l}}}var ye=zl(),St,Ki,ya=(Ki=class{constructor(){B(this,St)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),$r(this.gcTime)&&R(this,St,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Ot?1/0:5*60*1e3))}clearGcTimeout(){y(this,St)&&(clearTimeout(y(this,St)),R(this,St,void 0))}},St=new WeakMap,Ki),Yt,Xt,Oe,xe,Es,jt,Me,Qe,zi,Wl=(zi=class extends ya{constructor(e){super();B(this,Me);B(this,Yt);B(this,Xt);B(this,Oe);B(this,xe);B(this,Es);B(this,jt);R(this,jt,!1),R(this,Es,e.defaultOptions),this.setOptions(e.options),this.observers=[],R(this,Oe,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,R(this,Yt,Vl(this.options)),this.state=e.state??y(this,Yt),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=y(this,xe))==null?void 0:e.promise}setOptions(e){this.options={...y(this,Es),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&y(this,Oe).remove(this)}setData(e,t){const s=Ur(this.state.data,e,this.options);return J(this,Me,Qe).call(this,{data:s,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),s}setState(e,t){J(this,Me,Qe).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var s,n;const t=(s=y(this,xe))==null?void 0:s.promise;return(n=y(this,xe))==null||n.cancel(e),t?t.then(Ae).catch(Ae):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(y(this,Yt))}isActive(){return this.observers.some(e=>Fe(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===bn||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!ua(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=y(this,xe))==null||t.continue()}onOnline(){var t;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=y(this,xe))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),y(this,Oe).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(y(this,xe)&&(y(this,jt)?y(this,xe).cancel({revert:!0}):y(this,xe).cancelRetry()),this.scheduleGc()),y(this,Oe).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||J(this,Me,Qe).call(this,{type:"invalidate"})}fetch(e,t){var c,d,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(y(this,xe))return y(this,xe).continueRetry(),y(this,xe).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(f=>f.options.queryFn);h&&this.setOptions(h.options)}const s=new AbortController,n=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(R(this,jt,!0),s.signal)})},i=()=>{const h=fa(this.options,t),f={queryKey:this.queryKey,meta:this.meta};return n(f),R(this,jt,!1),this.options.persister?this.options.persister(h,f,this):h(f)},a={fetchOptions:t,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};n(a),(c=this.options.behavior)==null||c.onFetch(a,this),R(this,Xt,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=a.fetchOptions)==null?void 0:d.meta))&&J(this,Me,Qe).call(this,{type:"fetch",meta:(u=a.fetchOptions)==null?void 0:u.meta});const l=h=>{var f,p,b,v;br(h)&&h.silent||J(this,Me,Qe).call(this,{type:"error",error:h}),br(h)||((p=(f=y(this,Oe).config).onError)==null||p.call(f,h,this),(v=(b=y(this,Oe).config).onSettled)==null||v.call(b,this.state.data,h,this)),this.scheduleGc()};return R(this,xe,ma({initialPromise:t==null?void 0:t.initialPromise,fn:a.fetchFn,abort:s.abort.bind(s),onSuccess:h=>{var f,p,b,v;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(m){l(m);return}(p=(f=y(this,Oe).config).onSuccess)==null||p.call(f,h,this),(v=(b=y(this,Oe).config).onSettled)==null||v.call(b,h,this.state.error,this),this.scheduleGc()},onError:l,onFail:(h,f)=>{J(this,Me,Qe).call(this,{type:"failed",failureCount:h,error:f})},onPause:()=>{J(this,Me,Qe).call(this,{type:"pause"})},onContinue:()=>{J(this,Me,Qe).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),y(this,xe).start()}},Yt=new WeakMap,Xt=new WeakMap,Oe=new WeakMap,xe=new WeakMap,Es=new WeakMap,jt=new WeakMap,Me=new WeakSet,Qe=function(e){const t=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...va(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return br(n)&&n.revert&&y(this,Xt)?{...y(this,Xt),fetchStatus:"idle"}:{...s,error:n,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=t(this.state),ye.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),y(this,Oe).notify({query:this,type:"updated",action:e})})},zi);function va(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ga(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function Vl(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,s=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var qe,Wi,Hl=(Wi=class extends Os{constructor(e={}){super();B(this,qe);this.config=e,R(this,qe,new Map)}build(e,t,s){const n=t.queryKey,i=t.queryHash??vn(n,t);let a=this.get(i);return a||(a=new Wl({cache:this,queryKey:n,queryHash:i,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){y(this,qe).has(e.queryHash)||(y(this,qe).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=y(this,qe).get(e.queryHash);t&&(e.destroy(),t===e&&y(this,qe).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ye.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return y(this,qe).get(e)}getAll(){return[...y(this,qe).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Qn(t,s))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(s=>Qn(e,s)):t}notify(e){ye.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){ye.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ye.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},qe=new WeakMap,Wi),Ke,ke,Et,ze,rt,Vi,Gl=(Vi=class extends ya{constructor(e){super();B(this,ze);B(this,Ke);B(this,ke);B(this,Et);this.mutationId=e.mutationId,R(this,ke,e.mutationCache),R(this,Ke,[]),this.state=e.state||Ql(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){y(this,Ke).includes(e)||(y(this,Ke).push(e),this.clearGcTimeout(),y(this,ke).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){R(this,Ke,y(this,Ke).filter(t=>t!==e)),this.scheduleGc(),y(this,ke).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){y(this,Ke).length||(this.state.status==="pending"?this.scheduleGc():y(this,ke).remove(this))}continue(){var e;return((e=y(this,Et))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var n,i,a,l,c,d,u,h,f,p,b,v,m,x,_,w,k,A,C,O;R(this,Et,ma({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(V,q)=>{J(this,ze,rt).call(this,{type:"failed",failureCount:V,error:q})},onPause:()=>{J(this,ze,rt).call(this,{type:"pause"})},onContinue:()=>{J(this,ze,rt).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>y(this,ke).canRun(this)}));const t=this.state.status==="pending",s=!y(this,Et).canStart();try{if(!t){J(this,ze,rt).call(this,{type:"pending",variables:e,isPaused:s}),await((i=(n=y(this,ke).config).onMutate)==null?void 0:i.call(n,e,this));const q=await((l=(a=this.options).onMutate)==null?void 0:l.call(a,e));q!==this.state.context&&J(this,ze,rt).call(this,{type:"pending",context:q,variables:e,isPaused:s})}const V=await y(this,Et).start();return await((d=(c=y(this,ke).config).onSuccess)==null?void 0:d.call(c,V,e,this.state.context,this)),await((h=(u=this.options).onSuccess)==null?void 0:h.call(u,V,e,this.state.context)),await((p=(f=y(this,ke).config).onSettled)==null?void 0:p.call(f,V,null,this.state.variables,this.state.context,this)),await((v=(b=this.options).onSettled)==null?void 0:v.call(b,V,null,e,this.state.context)),J(this,ze,rt).call(this,{type:"success",data:V}),V}catch(V){try{throw await((x=(m=y(this,ke).config).onError)==null?void 0:x.call(m,V,e,this.state.context,this)),await((w=(_=this.options).onError)==null?void 0:w.call(_,V,e,this.state.context)),await((A=(k=y(this,ke).config).onSettled)==null?void 0:A.call(k,void 0,V,this.state.variables,this.state.context,this)),await((O=(C=this.options).onSettled)==null?void 0:O.call(C,void 0,V,e,this.state.context)),V}finally{J(this,ze,rt).call(this,{type:"error",error:V})}}finally{y(this,ke).runNext(this)}}},Ke=new WeakMap,ke=new WeakMap,Et=new WeakMap,ze=new WeakSet,rt=function(e){const t=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),ye.batch(()=>{y(this,Ke).forEach(s=>{s.onMutationUpdate(e)}),y(this,ke).notify({mutation:this,type:"updated",action:e})})},Vi);function Ql(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Te,Cs,Hi,Jl=(Hi=class extends Os{constructor(e={}){super();B(this,Te);B(this,Cs);this.config=e,R(this,Te,new Map),R(this,Cs,Date.now())}build(e,t,s){const n=new Gl({mutationCache:this,mutationId:++Is(this,Cs)._,options:e.defaultMutationOptions(t),state:s});return this.add(n),n}add(e){const t=$s(e),s=y(this,Te).get(t)??[];s.push(e),y(this,Te).set(t,s),this.notify({type:"added",mutation:e})}remove(e){var s;const t=$s(e);if(y(this,Te).has(t)){const n=(s=y(this,Te).get(t))==null?void 0:s.filter(i=>i!==e);n&&(n.length===0?y(this,Te).delete(t):y(this,Te).set(t,n))}this.notify({type:"removed",mutation:e})}canRun(e){var s;const t=(s=y(this,Te).get($s(e)))==null?void 0:s.find(n=>n.state.status==="pending");return!t||t===e}runNext(e){var s;const t=(s=y(this,Te).get($s(e)))==null?void 0:s.find(n=>n!==e&&n.state.isPaused);return(t==null?void 0:t.continue())??Promise.resolve()}clear(){ye.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...y(this,Te).values()].flat()}find(e){const t={exact:!0,...e};return this.getAll().find(s=>Jn(t,s))}findAll(e={}){return this.getAll().filter(t=>Jn(e,t))}notify(e){ye.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return ye.batch(()=>Promise.all(e.map(t=>t.continue().catch(Ae))))}},Te=new WeakMap,Cs=new WeakMap,Hi);function $s(r){var e;return((e=r.options.scope)==null?void 0:e.id)??String(r.mutationId)}function Zn(r){return{onFetch:(e,t)=>{var u,h,f,p,b;const s=e.options,n=(f=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],a=((b=e.state.data)==null?void 0:b.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let v=!1;const m=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},x=fa(e.options,e.fetchOptions),_=async(w,k,A)=>{if(v)return Promise.reject();if(k==null&&w.pages.length)return Promise.resolve(w);const C={queryKey:e.queryKey,pageParam:k,direction:A?"backward":"forward",meta:e.options.meta};m(C);const O=await x(C),{maxPages:V}=e.options,q=A?Fl:Ul;return{pages:q(w.pages,O,V),pageParams:q(w.pageParams,k,V)}};if(n&&i.length){const w=n==="backward",k=w?Yl:ei,A={pages:i,pageParams:a},C=k(s,A);l=await _(A,C,w)}else{const w=r??i.length;do{const k=c===0?a[0]??s.initialPageParam:ei(s,l);if(c>0&&k==null)break;l=await _(l,k),c++}while(c<w)}return l};e.options.persister?e.fetchFn=()=>{var v,m;return(m=(v=e.options).persister)==null?void 0:m.call(v,d,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function ei(r,{pages:e,pageParams:t}){const s=e.length-1;return e.length>0?r.getNextPageParam(e[s],e,t[s],t):void 0}function Yl(r,{pages:e,pageParams:t}){var s;return e.length>0?(s=r.getPreviousPageParam)==null?void 0:s.call(r,e[0],e,t[0],t):void 0}var oe,ct,dt,Zt,es,ut,ts,ss,Gi,Xl=(Gi=class{constructor(r={}){B(this,oe);B(this,ct);B(this,dt);B(this,Zt);B(this,es);B(this,ut);B(this,ts);B(this,ss);R(this,oe,r.queryCache||new Hl),R(this,ct,r.mutationCache||new Jl),R(this,dt,r.defaultOptions||{}),R(this,Zt,new Map),R(this,es,new Map),R(this,ut,0)}mount(){Is(this,ut)._++,y(this,ut)===1&&(R(this,ts,wn.subscribe(async r=>{r&&(await this.resumePausedMutations(),y(this,oe).onFocus())})),R(this,ss,Vs.subscribe(async r=>{r&&(await this.resumePausedMutations(),y(this,oe).onOnline())})))}unmount(){var r,e;Is(this,ut)._--,y(this,ut)===0&&((r=y(this,ts))==null||r.call(this),R(this,ts,void 0),(e=y(this,ss))==null||e.call(this),R(this,ss,void 0))}isFetching(r){return y(this,oe).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return y(this,ct).findAll({...r,status:"pending"}).length}getQueryData(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=y(this,oe).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(r){const e=this.getQueryData(r.queryKey);if(e===void 0)return this.fetchQuery(r);{const t=this.defaultQueryOptions(r),s=y(this,oe).build(this,t);return r.revalidateIfStale&&s.isStaleByTime(Wt(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(r){return y(this,oe).findAll(r).map(({queryKey:e,state:t})=>{const s=t.data;return[e,s]})}setQueryData(r,e,t){const s=this.defaultQueryOptions({queryKey:r}),n=y(this,oe).get(s.queryHash),i=n==null?void 0:n.state.data,a=Ml(e,i);if(a!==void 0)return y(this,oe).build(this,s).setData(a,{...t,manual:!0})}setQueriesData(r,e,t){return ye.batch(()=>y(this,oe).findAll(r).map(({queryKey:s})=>[s,this.setQueryData(s,e,t)]))}getQueryState(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=y(this,oe).get(e.queryHash))==null?void 0:t.state}removeQueries(r){const e=y(this,oe);ye.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=y(this,oe),s={type:"active",...r};return ye.batch(()=>(t.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries(s,e)))}cancelQueries(r={},e={}){const t={revert:!0,...e},s=ye.batch(()=>y(this,oe).findAll(r).map(n=>n.cancel(t)));return Promise.all(s).then(Ae).catch(Ae)}invalidateQueries(r={},e={}){return ye.batch(()=>{if(y(this,oe).findAll(r).forEach(s=>{s.invalidate()}),r.refetchType==="none")return Promise.resolve();const t={...r,type:r.refetchType??r.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(r={},e){const t={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},s=ye.batch(()=>y(this,oe).findAll(r).filter(n=>!n.isDisabled()).map(n=>{let i=n.fetch(void 0,t);return t.throwOnError||(i=i.catch(Ae)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ae)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=y(this,oe).build(this,e);return t.isStaleByTime(Wt(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Ae).catch(Ae)}fetchInfiniteQuery(r){return r.behavior=Zn(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Ae).catch(Ae)}ensureInfiniteQueryData(r){return r.behavior=Zn(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Vs.isOnline()?y(this,ct).resumePausedMutations():Promise.resolve()}getQueryCache(){return y(this,oe)}getMutationCache(){return y(this,ct)}getDefaultOptions(){return y(this,dt)}setDefaultOptions(r){R(this,dt,r)}setQueryDefaults(r,e){y(this,Zt).set(_s(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...y(this,Zt).values()];let t={};return e.forEach(s=>{ks(r,s.queryKey)&&(t={...t,...s.defaultOptions})}),t}setMutationDefaults(r,e){y(this,es).set(_s(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...y(this,es).values()];let t={};return e.forEach(s=>{ks(r,s.mutationKey)&&(t={...t,...s.defaultOptions})}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...y(this,dt).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=vn(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===bn&&(e.enabled=!1),e}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...y(this,dt).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){y(this,oe).clear(),y(this,ct).clear()}},oe=new WeakMap,ct=new WeakMap,dt=new WeakMap,Zt=new WeakMap,es=new WeakMap,ut=new WeakMap,ts=new WeakMap,ss=new WeakMap,Gi),Ee,Y,Ts,Se,Ct,rs,ht,We,Ns,ns,is,Tt,Nt,ft,as,X,ms,Br,qr,Kr,zr,Wr,Vr,Hr,ba,Qi,Zl=(Qi=class extends Os{constructor(e,t){super();B(this,X);B(this,Ee);B(this,Y);B(this,Ts);B(this,Se);B(this,Ct);B(this,rs);B(this,ht);B(this,We);B(this,Ns);B(this,ns);B(this,is);B(this,Tt);B(this,Nt);B(this,ft);B(this,as,new Set);this.options=t,R(this,Ee,e),R(this,We,null),R(this,ht,Fr()),this.options.experimental_prefetchInRender||y(this,ht).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(y(this,Y).addObserver(this),ti(y(this,Y),this.options)?J(this,X,ms).call(this):this.updateResult(),J(this,X,zr).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Gr(y(this,Y),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Gr(y(this,Y),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,J(this,X,Wr).call(this),J(this,X,Vr).call(this),y(this,Y).removeObserver(this)}setOptions(e,t){const s=this.options,n=y(this,Y);if(this.options=y(this,Ee).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Fe(this.options.enabled,y(this,Y))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");J(this,X,Hr).call(this),y(this,Y).setOptions(this.options),s._defaulted&&!Mr(this.options,s)&&y(this,Ee).getQueryCache().notify({type:"observerOptionsUpdated",query:y(this,Y),observer:this});const i=this.hasListeners();i&&si(y(this,Y),n,this.options,s)&&J(this,X,ms).call(this),this.updateResult(t),i&&(y(this,Y)!==n||Fe(this.options.enabled,y(this,Y))!==Fe(s.enabled,y(this,Y))||Wt(this.options.staleTime,y(this,Y))!==Wt(s.staleTime,y(this,Y)))&&J(this,X,Br).call(this);const a=J(this,X,qr).call(this);i&&(y(this,Y)!==n||Fe(this.options.enabled,y(this,Y))!==Fe(s.enabled,y(this,Y))||a!==y(this,ft))&&J(this,X,Kr).call(this,a)}getOptimisticResult(e){const t=y(this,Ee).getQueryCache().build(y(this,Ee),e),s=this.createResult(t,e);return tc(this,s)&&(R(this,Se,s),R(this,rs,this.options),R(this,Ct,y(this,Y).state)),s}getCurrentResult(){return y(this,Se)}trackResult(e,t){const s={};return Object.keys(e).forEach(n=>{Object.defineProperty(s,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),t==null||t(n),e[n])})}),s}trackProp(e){y(this,as).add(e)}getCurrentQuery(){return y(this,Y)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=y(this,Ee).defaultQueryOptions(e),s=y(this,Ee).getQueryCache().build(y(this,Ee),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return J(this,X,ms).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),y(this,Se)))}createResult(e,t){var V;const s=y(this,Y),n=this.options,i=y(this,Se),a=y(this,Ct),l=y(this,rs),d=e!==s?e.state:y(this,Ts),{state:u}=e;let h={...u},f=!1,p;if(t._optimisticResults){const q=this.hasListeners(),G=!q&&ti(e,t),T=q&&si(e,s,t,n);(G||T)&&(h={...h,...va(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:b,errorUpdatedAt:v,status:m}=h;if(t.select&&h.data!==void 0)if(i&&h.data===(a==null?void 0:a.data)&&t.select===y(this,Ns))p=y(this,ns);else try{R(this,Ns,t.select),p=t.select(h.data),p=Ur(i==null?void 0:i.data,p,t),R(this,ns,p),R(this,We,null)}catch(q){R(this,We,q)}else p=h.data;if(t.placeholderData!==void 0&&p===void 0&&m==="pending"){let q;if(i!=null&&i.isPlaceholderData&&t.placeholderData===(l==null?void 0:l.placeholderData))q=i.data;else if(q=typeof t.placeholderData=="function"?t.placeholderData((V=y(this,is))==null?void 0:V.state.data,y(this,is)):t.placeholderData,t.select&&q!==void 0)try{q=t.select(q),R(this,We,null)}catch(G){R(this,We,G)}q!==void 0&&(m="success",p=Ur(i==null?void 0:i.data,q,t),f=!0)}y(this,We)&&(b=y(this,We),p=y(this,ns),v=Date.now(),m="error");const x=h.fetchStatus==="fetching",_=m==="pending",w=m==="error",k=_&&x,A=p!==void 0,O={status:m,fetchStatus:h.fetchStatus,isPending:_,isSuccess:m==="success",isError:w,isInitialLoading:k,isLoading:k,data:p,dataUpdatedAt:h.dataUpdatedAt,error:b,errorUpdatedAt:v,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:x,isRefetching:x&&!_,isLoadingError:w&&!A,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&A,isStale:xn(e,t),refetch:this.refetch,promise:y(this,ht)};if(this.options.experimental_prefetchInRender){const q=$=>{O.status==="error"?$.reject(O.error):O.data!==void 0&&$.resolve(O.data)},G=()=>{const $=R(this,ht,O.promise=Fr());q($)},T=y(this,ht);switch(T.status){case"pending":e.queryHash===s.queryHash&&q(T);break;case"fulfilled":(O.status==="error"||O.data!==T.value)&&G();break;case"rejected":(O.status!=="error"||O.error!==T.reason)&&G();break}}return O}updateResult(e){const t=y(this,Se),s=this.createResult(y(this,Y),this.options);if(R(this,Ct,y(this,Y).state),R(this,rs,this.options),y(this,Ct).data!==void 0&&R(this,is,y(this,Y)),Mr(s,t))return;R(this,Se,s);const n={},i=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,l=typeof a=="function"?a():a;if(l==="all"||!l&&!y(this,as).size)return!0;const c=new Set(l??y(this,as));return this.options.throwOnError&&c.add("error"),Object.keys(y(this,Se)).some(d=>{const u=d;return y(this,Se)[u]!==t[u]&&c.has(u)})};(e==null?void 0:e.listeners)!==!1&&i()&&(n.listeners=!0),J(this,X,ba).call(this,{...n,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&J(this,X,zr).call(this)}},Ee=new WeakMap,Y=new WeakMap,Ts=new WeakMap,Se=new WeakMap,Ct=new WeakMap,rs=new WeakMap,ht=new WeakMap,We=new WeakMap,Ns=new WeakMap,ns=new WeakMap,is=new WeakMap,Tt=new WeakMap,Nt=new WeakMap,ft=new WeakMap,as=new WeakMap,X=new WeakSet,ms=function(e){J(this,X,Hr).call(this);let t=y(this,Y).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(Ae)),t},Br=function(){J(this,X,Wr).call(this);const e=Wt(this.options.staleTime,y(this,Y));if(Ot||y(this,Se).isStale||!$r(e))return;const s=ua(y(this,Se).dataUpdatedAt,e)+1;R(this,Tt,setTimeout(()=>{y(this,Se).isStale||this.updateResult()},s))},qr=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(y(this,Y)):this.options.refetchInterval)??!1},Kr=function(e){J(this,X,Vr).call(this),R(this,ft,e),!(Ot||Fe(this.options.enabled,y(this,Y))===!1||!$r(y(this,ft))||y(this,ft)===0)&&R(this,Nt,setInterval(()=>{(this.options.refetchIntervalInBackground||wn.isFocused())&&J(this,X,ms).call(this)},y(this,ft)))},zr=function(){J(this,X,Br).call(this),J(this,X,Kr).call(this,J(this,X,qr).call(this))},Wr=function(){y(this,Tt)&&(clearTimeout(y(this,Tt)),R(this,Tt,void 0))},Vr=function(){y(this,Nt)&&(clearInterval(y(this,Nt)),R(this,Nt,void 0))},Hr=function(){const e=y(this,Ee).getQueryCache().build(y(this,Ee),this.options);if(e===y(this,Y))return;const t=y(this,Y);R(this,Y,e),R(this,Ts,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},ba=function(e){ye.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(y(this,Se))}),y(this,Ee).getQueryCache().notify({query:y(this,Y),type:"observerResultsUpdated"})})},Qi);function ec(r,e){return Fe(e.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&e.retryOnMount===!1)}function ti(r,e){return ec(r,e)||r.state.data!==void 0&&Gr(r,e,e.refetchOnMount)}function Gr(r,e,t){if(Fe(e.enabled,r)!==!1){const s=typeof t=="function"?t(r):t;return s==="always"||s!==!1&&xn(r,e)}return!1}function si(r,e,t,s){return(r!==e||Fe(s.enabled,r)===!1)&&(!t.suspense||r.state.status!=="error")&&xn(r,t)}function xn(r,e){return Fe(e.enabled,r)!==!1&&r.isStaleByTime(Wt(e.staleTime,r))}function tc(r,e){return!Mr(r.getCurrentResult(),e)}var wa=g.createContext(void 0),_n=r=>{const e=g.useContext(wa);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},sc=({client:r,children:e})=>(g.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),o.jsx(wa.Provider,{value:r,children:e})),xa=g.createContext(!1),rc=()=>g.useContext(xa);xa.Provider;function nc(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var ic=g.createContext(nc()),ac=()=>g.useContext(ic);function oc(r,e){return typeof r=="function"?r(...e):!!r}function ri(){}var lc=(r,e)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(e.isReset()||(r.retryOnMount=!1))},cc=r=>{g.useEffect(()=>{r.clearReset()},[r])},dc=({result:r,errorResetBoundary:e,throwOnError:t,query:s})=>r.isError&&!e.isReset()&&!r.isFetching&&s&&oc(t,[r.error,s]),uc=r=>{r.suspense&&(r.staleTime===void 0&&(r.staleTime=1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},hc=(r,e)=>r.isLoading&&r.isFetching&&!e,fc=(r,e)=>(r==null?void 0:r.suspense)&&e.isPending,ni=(r,e,t)=>e.fetchOptimistic(r).catch(()=>{t.clearReset()});function gc(r,e,t){var u,h,f,p,b;const s=_n(),n=rc(),i=ac(),a=s.defaultQueryOptions(r);(h=(u=s.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||h.call(u,a),a._optimisticResults=n?"isRestoring":"optimistic",uc(a),lc(a,i),cc(i);const l=!s.getQueryCache().get(a.queryHash),[c]=g.useState(()=>new e(s,a)),d=c.getOptimisticResult(a);if(g.useSyncExternalStore(g.useCallback(v=>{const m=n?ri:c.subscribe(ye.batchCalls(v));return c.updateResult(),m},[c,n]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),g.useEffect(()=>{c.setOptions(a,{listeners:!1})},[a,c]),fc(a,d))throw ni(a,c,i);if(dc({result:d,errorResetBoundary:i,throwOnError:a.throwOnError,query:s.getQueryCache().get(a.queryHash)}))throw d.error;if((p=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,a,d),a.experimental_prefetchInRender&&!Ot&&hc(d,n)){const v=l?ni(a,c,i):(b=s.getQueryCache().get(a.queryHash))==null?void 0:b.promise;v==null||v.catch(ri).finally(()=>{c.updateResult()})}return a.notifyOnChangeProps?d:c.trackResult(d)}function kn(r,e){return gc(r,Zl)}async function pc(r){if(!r.ok){const e=await r.text()||r.statusText;throw new Error(`${r.status}: ${e}`)}}const mc=({on401:r})=>async({queryKey:e})=>{const t=await fetch(e.join("/"),{credentials:"include"});return r==="returnNull"&&t.status===401?null:(await pc(t),await t.json())},yc=new Xl({defaultOptions:{queries:{queryFn:mc({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),vc=1,bc=1e6;let wr=0;function wc(){return wr=(wr+1)%Number.MAX_SAFE_INTEGER,wr.toString()}const xr=new Map,ii=r=>{if(xr.has(r))return;const e=setTimeout(()=>{xr.delete(r),vs({type:"REMOVE_TOAST",toastId:r})},bc);xr.set(r,e)},xc=(r,e)=>{switch(e.type){case"ADD_TOAST":return{...r,toasts:[e.toast,...r.toasts].slice(0,vc)};case"UPDATE_TOAST":return{...r,toasts:r.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?ii(t):r.toasts.forEach(s=>{ii(s.id)}),{...r,toasts:r.toasts.map(s=>s.id===t||t===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(t=>t.id!==e.toastId)}}},Ks=[];let zs={toasts:[]};function vs(r){zs=xc(zs,r),Ks.forEach(e=>{e(zs)})}function _c({...r}){const e=wc(),t=n=>vs({type:"UPDATE_TOAST",toast:{...n,id:e}}),s=()=>vs({type:"DISMISS_TOAST",toastId:e});return vs({type:"ADD_TOAST",toast:{...r,id:e,open:!0,onOpenChange:n=>{n||s()}}}),{id:e,dismiss:s,update:t}}function Sn(){const[r,e]=g.useState(zs);return g.useEffect(()=>(Ks.push(e),()=>{const t=Ks.indexOf(e);t>-1&&Ks.splice(t,1)}),[r]),{...r,toast:_c,dismiss:t=>vs({type:"DISMISS_TOAST",toastId:t})}}var jn="ToastProvider",[En,kc,Sc]=cl("Toast"),[_a,Og]=Xs("Toast",[Sc]),[jc,er]=_a(jn),ka=r=>{const{__scopeToast:e,label:t="Notification",duration:s=5e3,swipeDirection:n="right",swipeThreshold:i=50,children:a}=r,[l,c]=g.useState(null),[d,u]=g.useState(0),h=g.useRef(!1),f=g.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${jn}\`. Expected non-empty \`string\`.`),o.jsx(En.Provider,{scope:e,children:o.jsx(jc,{scope:e,label:t,duration:s,swipeDirection:n,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:g.useCallback(()=>u(p=>p+1),[]),onToastRemove:g.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:a})})};ka.displayName=jn;var Sa="ToastViewport",Ec=["F8"],Qr="toast.viewportPause",Jr="toast.viewportResume",ja=g.forwardRef((r,e)=>{const{__scopeToast:t,hotkey:s=Ec,label:n="Notifications ({hotkey})",...i}=r,a=er(Sa,t),l=kc(t),c=g.useRef(null),d=g.useRef(null),u=g.useRef(null),h=g.useRef(null),f=Ds(e,h,a.onViewportChange),p=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=a.toastCount>0;g.useEffect(()=>{const m=x=>{var w;s.length!==0&&s.every(k=>x[k]||x.code===k)&&((w=h.current)==null||w.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[s]),g.useEffect(()=>{const m=c.current,x=h.current;if(b&&m&&x){const _=()=>{if(!a.isClosePausedRef.current){const C=new CustomEvent(Qr);x.dispatchEvent(C),a.isClosePausedRef.current=!0}},w=()=>{if(a.isClosePausedRef.current){const C=new CustomEvent(Jr);x.dispatchEvent(C),a.isClosePausedRef.current=!1}},k=C=>{!m.contains(C.relatedTarget)&&w()},A=()=>{m.contains(document.activeElement)||w()};return m.addEventListener("focusin",_),m.addEventListener("focusout",k),m.addEventListener("pointermove",_),m.addEventListener("pointerleave",A),window.addEventListener("blur",_),window.addEventListener("focus",w),()=>{m.removeEventListener("focusin",_),m.removeEventListener("focusout",k),m.removeEventListener("pointermove",_),m.removeEventListener("pointerleave",A),window.removeEventListener("blur",_),window.removeEventListener("focus",w)}}},[b,a.isClosePausedRef]);const v=g.useCallback(({tabbingDirection:m})=>{const _=l().map(w=>{const k=w.ref.current,A=[k,...Uc(k)];return m==="forwards"?A:A.reverse()});return(m==="forwards"?_.reverse():_).flat()},[l]);return g.useEffect(()=>{const m=h.current;if(m){const x=_=>{var A,C,O;const w=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!w){const V=document.activeElement,q=_.shiftKey;if(_.target===m&&q){(A=d.current)==null||A.focus();return}const $=v({tabbingDirection:q?"backwards":"forwards"}),le=$.findIndex(S=>S===V);_r($.slice(le+1))?_.preventDefault():q?(C=d.current)==null||C.focus():(O=u.current)==null||O.focus()}};return m.addEventListener("keydown",x),()=>m.removeEventListener("keydown",x)}},[l,v]),o.jsxs(dl,{ref:c,role:"region","aria-label":n.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&o.jsx(Yr,{ref:d,onFocusFromOutsideViewport:()=>{const m=v({tabbingDirection:"forwards"});_r(m)}}),o.jsx(En.Slot,{scope:t,children:o.jsx(Pe.ol,{tabIndex:-1,...i,ref:f})}),b&&o.jsx(Yr,{ref:u,onFocusFromOutsideViewport:()=>{const m=v({tabbingDirection:"backwards"});_r(m)}})]})});ja.displayName=Sa;var Ea="ToastFocusProxy",Yr=g.forwardRef((r,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:s,...n}=r,i=er(Ea,t);return o.jsx(Ji,{"aria-hidden":!0,tabIndex:0,...n,ref:e,style:{position:"fixed"},onFocus:a=>{var d;const l=a.relatedTarget;!((d=i.viewport)!=null&&d.contains(l))&&s()}})});Yr.displayName=Ea;var tr="Toast",Cc="toast.swipeStart",Tc="toast.swipeMove",Nc="toast.swipeCancel",Dc="toast.swipeEnd",Ca=g.forwardRef((r,e)=>{const{forceMount:t,open:s,defaultOpen:n,onOpenChange:i,...a}=r,[l=!0,c]=mn({prop:s,defaultProp:n,onChange:i});return o.jsx(yn,{present:t||l,children:o.jsx(Pc,{open:l,...a,ref:e,onClose:()=>c(!1),onPause:Ws(r.onPause),onResume:Ws(r.onResume),onSwipeStart:ge(r.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ge(r.onSwipeMove,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:ge(r.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ge(r.onSwipeEnd,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});Ca.displayName=tr;var[Oc,Ac]=_a(tr,{onClose(){}}),Pc=g.forwardRef((r,e)=>{const{__scopeToast:t,type:s="foreground",duration:n,open:i,onClose:a,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:p,...b}=r,v=er(tr,t),[m,x]=g.useState(null),_=Ds(e,S=>x(S)),w=g.useRef(null),k=g.useRef(null),A=n||v.duration,C=g.useRef(0),O=g.useRef(A),V=g.useRef(0),{onToastAdd:q,onToastRemove:G}=v,T=Ws(()=>{var E;(m==null?void 0:m.contains(document.activeElement))&&((E=v.viewport)==null||E.focus()),a()}),$=g.useCallback(S=>{!S||S===1/0||(window.clearTimeout(V.current),C.current=new Date().getTime(),V.current=window.setTimeout(T,S))},[T]);g.useEffect(()=>{const S=v.viewport;if(S){const E=()=>{$(O.current),d==null||d()},j=()=>{const P=new Date().getTime()-C.current;O.current=O.current-P,window.clearTimeout(V.current),c==null||c()};return S.addEventListener(Qr,j),S.addEventListener(Jr,E),()=>{S.removeEventListener(Qr,j),S.removeEventListener(Jr,E)}}},[v.viewport,A,c,d,$]),g.useEffect(()=>{i&&!v.isClosePausedRef.current&&$(A)},[i,A,v.isClosePausedRef,$]),g.useEffect(()=>(q(),()=>G()),[q,G]);const le=g.useMemo(()=>m?Ra(m):null,[m]);return v.viewport?o.jsxs(o.Fragment,{children:[le&&o.jsx(Rc,{__scopeToast:t,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:le}),o.jsx(Oc,{scope:t,onClose:T,children:ca.createPortal(o.jsx(En.ItemSlot,{scope:t,children:o.jsx(ul,{asChild:!0,onEscapeKeyDown:ge(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||T(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(Pe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...b,ref:_,style:{userSelect:"none",touchAction:"none",...r.style},onKeyDown:ge(r.onKeyDown,S=>{S.key==="Escape"&&(l==null||l(S.nativeEvent),S.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,T()))}),onPointerDown:ge(r.onPointerDown,S=>{S.button===0&&(w.current={x:S.clientX,y:S.clientY})}),onPointerMove:ge(r.onPointerMove,S=>{if(!w.current)return;const E=S.clientX-w.current.x,j=S.clientY-w.current.y,P=!!k.current,N=["left","right"].includes(v.swipeDirection),I=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,L=N?I(0,E):0,H=N?0:I(0,j),Z=S.pointerType==="touch"?10:2,ee={x:L,y:H},ie={originalEvent:S,delta:ee};P?(k.current=ee,Ms(Tc,h,ie,{discrete:!1})):ai(ee,v.swipeDirection,Z)?(k.current=ee,Ms(Cc,u,ie,{discrete:!1}),S.target.setPointerCapture(S.pointerId)):(Math.abs(E)>Z||Math.abs(j)>Z)&&(w.current=null)}),onPointerUp:ge(r.onPointerUp,S=>{const E=k.current,j=S.target;if(j.hasPointerCapture(S.pointerId)&&j.releasePointerCapture(S.pointerId),k.current=null,w.current=null,E){const P=S.currentTarget,N={originalEvent:S,delta:E};ai(E,v.swipeDirection,v.swipeThreshold)?Ms(Dc,p,N,{discrete:!0}):Ms(Nc,f,N,{discrete:!0}),P.addEventListener("click",I=>I.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),Rc=r=>{const{__scopeToast:e,children:t,...s}=r,n=er(tr,e),[i,a]=g.useState(!1),[l,c]=g.useState(!1);return Mc(()=>a(!0)),g.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:o.jsx(hl,{asChild:!0,children:o.jsx(Ji,{...s,children:i&&o.jsxs(o.Fragment,{children:[n.label," ",t]})})})},Ic="ToastTitle",Ta=g.forwardRef((r,e)=>{const{__scopeToast:t,...s}=r;return o.jsx(Pe.div,{...s,ref:e})});Ta.displayName=Ic;var $c="ToastDescription",Na=g.forwardRef((r,e)=>{const{__scopeToast:t,...s}=r;return o.jsx(Pe.div,{...s,ref:e})});Na.displayName=$c;var Da="ToastAction",Oa=g.forwardRef((r,e)=>{const{altText:t,...s}=r;return t.trim()?o.jsx(Pa,{altText:t,asChild:!0,children:o.jsx(Cn,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Da}\`. Expected non-empty \`string\`.`),null)});Oa.displayName=Da;var Aa="ToastClose",Cn=g.forwardRef((r,e)=>{const{__scopeToast:t,...s}=r,n=Ac(Aa,t);return o.jsx(Pa,{asChild:!0,children:o.jsx(Pe.button,{type:"button",...s,ref:e,onClick:ge(r.onClick,n.onClose)})})});Cn.displayName=Aa;var Pa=g.forwardRef((r,e)=>{const{__scopeToast:t,altText:s,...n}=r;return o.jsx(Pe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...n,ref:e})});function Ra(r){const e=[];return Array.from(r.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),Lc(s)){const n=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!n)if(i){const a=s.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...Ra(s))}}),e}function Ms(r,e,t,{discrete:s}){const n=t.originalEvent.currentTarget,i=new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:t});e&&n.addEventListener(r,e,{once:!0}),s?gl(n,i):n.dispatchEvent(i)}var ai=(r,e,t=0)=>{const s=Math.abs(r.x),n=Math.abs(r.y),i=s>n;return e==="left"||e==="right"?i&&s>t:!i&&n>t};function Mc(r=()=>{}){const e=Ws(r);fl(()=>{let t=0,s=0;return t=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(s)}},[e])}function Lc(r){return r.nodeType===r.ELEMENT_NODE}function Uc(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const n=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||n?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function _r(r){const e=document.activeElement;return r.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var Fc=ka,Ia=ja,$a=Ca,Ma=Ta,La=Na,Ua=Oa,Fa=Cn;function Ba(r){var e,t,s="";if(typeof r=="string"||typeof r=="number")s+=r;else if(typeof r=="object")if(Array.isArray(r)){var n=r.length;for(e=0;e<n;e++)r[e]&&(t=Ba(r[e]))&&(s&&(s+=" "),s+=t)}else for(t in r)r[t]&&(s&&(s+=" "),s+=t);return s}function qa(){for(var r,e,t=0,s="",n=arguments.length;t<n;t++)(r=arguments[t])&&(e=Ba(r))&&(s&&(s+=" "),s+=e);return s}const oi=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,li=qa,sr=(r,e)=>t=>{var s;if((e==null?void 0:e.variants)==null)return li(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:n,defaultVariants:i}=e,a=Object.keys(n).map(d=>{const u=t==null?void 0:t[d],h=i==null?void 0:i[d];if(u===null)return null;const f=oi(u)||oi(h);return n[d][f]}),l=t&&Object.entries(t).reduce((d,u)=>{let[h,f]=u;return f===void 0||(d[h]=f),d},{}),c=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((d,u)=>{let{class:h,className:f,...p}=u;return Object.entries(p).every(b=>{let[v,m]=b;return Array.isArray(m)?m.includes({...i,...l}[v]):{...i,...l}[v]===m})?[...d,h,f]:d},[]);return li(r,a,c,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ka=(...r)=>r.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=g.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:n="",children:i,iconNode:a,...l},c)=>g.createElement("svg",{ref:c,...qc,width:e,height:e,stroke:r,strokeWidth:s?Number(t)*24/Number(e):t,className:Ka("lucide",n),...l},[...a.map(([d,u])=>g.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=(r,e)=>{const t=g.forwardRef(({className:s,...n},i)=>g.createElement(Kc,{ref:i,iconNode:e,className:Ka(`lucide-${Bc(r)}`,s),...n}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=pe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=pe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=pe("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=pe("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=pe("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=pe("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=pe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=pe("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=pe("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=pe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=pe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=pe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Dn="-",sd=r=>{const e=nd(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=r;return{getClassGroupId:a=>{const l=a.split(Dn);return l[0]===""&&l.length!==1&&l.shift(),Va(l,e)||rd(a)},getConflictingClassGroupIds:(a,l)=>{const c=t[a]||[];return l&&s[a]?[...c,...s[a]]:c}}},Va=(r,e)=>{var a;if(r.length===0)return e.classGroupId;const t=r[0],s=e.nextPart.get(t),n=s?Va(r.slice(1),s):void 0;if(n)return n;if(e.validators.length===0)return;const i=r.join(Dn);return(a=e.validators.find(({validator:l})=>l(i)))==null?void 0:a.classGroupId},di=/^\[(.+)\]$/,rd=r=>{if(di.test(r)){const e=di.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},nd=r=>{const{theme:e,prefix:t}=r,s={nextPart:new Map,validators:[]};return ad(Object.entries(r.classGroups),t).forEach(([i,a])=>{Xr(a,s,i,e)}),s},Xr=(r,e,t,s)=>{r.forEach(n=>{if(typeof n=="string"){const i=n===""?e:ui(e,n);i.classGroupId=t;return}if(typeof n=="function"){if(id(n)){Xr(n(s),e,t,s);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,a])=>{Xr(a,ui(e,i),t,s)})})},ui=(r,e)=>{let t=r;return e.split(Dn).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},id=r=>r.isThemeGetter,ad=(r,e)=>e?r.map(([t,s])=>{const n=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,l])=>[e+a,l])):i);return[t,n]}):r,od=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,s=new Map;const n=(i,a)=>{t.set(i,a),e++,e>r&&(e=0,s=t,t=new Map)};return{get(i){let a=t.get(i);if(a!==void 0)return a;if((a=s.get(i))!==void 0)return n(i,a),a},set(i,a){t.has(i)?t.set(i,a):n(i,a)}}},Ha="!",ld=r=>{const{separator:e,experimentalParseClassName:t}=r,s=e.length===1,n=e[0],i=e.length,a=l=>{const c=[];let d=0,u=0,h;for(let m=0;m<l.length;m++){let x=l[m];if(d===0){if(x===n&&(s||l.slice(m,m+i)===e)){c.push(l.slice(u,m)),u=m+i;continue}if(x==="/"){h=m;continue}}x==="["?d++:x==="]"&&d--}const f=c.length===0?l:l.substring(u),p=f.startsWith(Ha),b=p?f.substring(1):f,v=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:b,maybePostfixModifierPosition:v}};return t?l=>t({className:l,parseClassName:a}):a},cd=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(s=>{s[0]==="["?(e.push(...t.sort(),s),t=[]):t.push(s)}),e.push(...t.sort()),e},dd=r=>({cache:od(r.cacheSize),parseClassName:ld(r),...sd(r)}),ud=/\s+/,hd=(r,e)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n}=e,i=[],a=r.trim().split(ud);let l="";for(let c=a.length-1;c>=0;c-=1){const d=a[c],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=t(d);let b=!!p,v=s(b?f.substring(0,p):f);if(!v){if(!b){l=d+(l.length>0?" "+l:l);continue}if(v=s(f),!v){l=d+(l.length>0?" "+l:l);continue}b=!1}const m=cd(u).join(":"),x=h?m+Ha:m,_=x+v;if(i.includes(_))continue;i.push(_);const w=n(v,b);for(let k=0;k<w.length;++k){const A=w[k];i.push(x+A)}l=d+(l.length>0?" "+l:l)}return l};function fd(){let r=0,e,t,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=Ga(e))&&(s&&(s+=" "),s+=t);return s}const Ga=r=>{if(typeof r=="string")return r;let e,t="";for(let s=0;s<r.length;s++)r[s]&&(e=Ga(r[s]))&&(t&&(t+=" "),t+=e);return t};function gd(r,...e){let t,s,n,i=a;function a(c){const d=e.reduce((u,h)=>h(u),r());return t=dd(d),s=t.cache.get,n=t.cache.set,i=l,l(c)}function l(c){const d=s(c);if(d)return d;const u=hd(c,t);return n(c,u),u}return function(){return i(fd.apply(null,arguments))}}const re=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},Qa=/^\[(?:([a-z-]+):)?(.+)\]$/i,pd=/^\d+\/\d+$/,md=new Set(["px","full","screen"]),yd=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,vd=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,bd=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,wd=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,xd=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ge=r=>Vt(r)||md.has(r)||pd.test(r),et=r=>cs(r,"length",Nd),Vt=r=>!!r&&!Number.isNaN(Number(r)),kr=r=>cs(r,"number",Vt),fs=r=>!!r&&Number.isInteger(Number(r)),_d=r=>r.endsWith("%")&&Vt(r.slice(0,-1)),W=r=>Qa.test(r),tt=r=>yd.test(r),kd=new Set(["length","size","percentage"]),Sd=r=>cs(r,kd,Ja),jd=r=>cs(r,"position",Ja),Ed=new Set(["image","url"]),Cd=r=>cs(r,Ed,Od),Td=r=>cs(r,"",Dd),gs=()=>!0,cs=(r,e,t)=>{const s=Qa.exec(r);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):t(s[2]):!1},Nd=r=>vd.test(r)&&!bd.test(r),Ja=()=>!1,Dd=r=>wd.test(r),Od=r=>xd.test(r),Ad=()=>{const r=re("colors"),e=re("spacing"),t=re("blur"),s=re("brightness"),n=re("borderColor"),i=re("borderRadius"),a=re("borderSpacing"),l=re("borderWidth"),c=re("contrast"),d=re("grayscale"),u=re("hueRotate"),h=re("invert"),f=re("gap"),p=re("gradientColorStops"),b=re("gradientColorStopPositions"),v=re("inset"),m=re("margin"),x=re("opacity"),_=re("padding"),w=re("saturate"),k=re("scale"),A=re("sepia"),C=re("skew"),O=re("space"),V=re("translate"),q=()=>["auto","contain","none"],G=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto",W,e],$=()=>[W,e],le=()=>["",Ge,et],S=()=>["auto",Vt,W],E=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],j=()=>["solid","dashed","dotted","double","none"],P=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],N=()=>["start","end","center","between","around","evenly","stretch"],I=()=>["","0",W],L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[Vt,W];return{cacheSize:500,separator:":",theme:{colors:[gs],spacing:[Ge,et],blur:["none","",tt,W],brightness:H(),borderColor:[r],borderRadius:["none","","full",tt,W],borderSpacing:$(),borderWidth:le(),contrast:H(),grayscale:I(),hueRotate:H(),invert:I(),gap:$(),gradientColorStops:[r],gradientColorStopPositions:[_d,et],inset:T(),margin:T(),opacity:H(),padding:$(),saturate:H(),scale:H(),sepia:I(),skew:H(),space:$(),translate:$()},classGroups:{aspect:[{aspect:["auto","square","video",W]}],container:["container"],columns:[{columns:[tt]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...E(),W]}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",fs,W]}],basis:[{basis:T()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",W]}],grow:[{grow:I()}],shrink:[{shrink:I()}],order:[{order:["first","last","none",fs,W]}],"grid-cols":[{"grid-cols":[gs]}],"col-start-end":[{col:["auto",{span:["full",fs,W]},W]}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":[gs]}],"row-start-end":[{row:["auto",{span:[fs,W]},W]}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",W]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",W]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...N()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...N(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...N(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[O]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[O]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",W,e]}],"min-w":[{"min-w":[W,e,"min","max","fit"]}],"max-w":[{"max-w":[W,e,"none","full","min","max","fit","prose",{screen:[tt]},tt]}],h:[{h:[W,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[W,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[W,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[W,e,"auto","min","max","fit"]}],"font-size":[{text:["base",tt,et]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",kr]}],"font-family":[{font:[gs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",W]}],"line-clamp":[{"line-clamp":["none",Vt,kr]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ge,W]}],"list-image":[{"list-image":["none",W]}],"list-style-type":[{list:["none","disc","decimal",W]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...j(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ge,et]}],"underline-offset":[{"underline-offset":["auto",Ge,W]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",W]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",W]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...E(),jd]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Sd]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Cd]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...j(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:j()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...j()]}],"outline-offset":[{"outline-offset":[Ge,W]}],"outline-w":[{outline:[Ge,et]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Ge,et]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",tt,Td]}],"shadow-color":[{shadow:[gs]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...P(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":P()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[s]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",tt,W]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",W]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",W]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",W]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[fs,W]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",W]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",W]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",W]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Ge,et,kr]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Pd=gd(Ad);function K(...r){return Pd(qa(r))}const Rd=Fc,Ya=g.forwardRef(({className:r,...e},t)=>o.jsx(Ia,{ref:t,className:K("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...e}));Ya.displayName=Ia.displayName;const Id=sr("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Xa=g.forwardRef(({className:r,variant:e,...t},s)=>o.jsx($a,{ref:s,className:K(Id({variant:e}),r),...t}));Xa.displayName=$a.displayName;const $d=g.forwardRef(({className:r,...e},t)=>o.jsx(Ua,{ref:t,className:K("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...e}));$d.displayName=Ua.displayName;const Za=g.forwardRef(({className:r,...e},t)=>o.jsx(Fa,{ref:t,className:K("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...e,children:o.jsx(Wa,{className:"h-4 w-4"})}));Za.displayName=Fa.displayName;const eo=g.forwardRef(({className:r,...e},t)=>o.jsx(Ma,{ref:t,className:K("text-sm font-semibold",r),...e}));eo.displayName=Ma.displayName;const to=g.forwardRef(({className:r,...e},t)=>o.jsx(La,{ref:t,className:K("text-sm opacity-90",r),...e}));to.displayName=La.displayName;function Md(){const{toasts:r}=Sn();return o.jsxs(Rd,{children:[r.map(function({id:e,title:t,description:s,action:n,...i}){return o.jsxs(Xa,{...i,children:[o.jsxs("div",{className:"grid gap-1",children:[t&&o.jsx(eo,{children:t}),s&&o.jsx(to,{children:s})]}),n,o.jsx(Za,{})]},e)}),o.jsx(Ya,{})]})}var[rr,Ag]=Xs("Tooltip",[Yi]),nr=Yi(),so="TooltipProvider",Ld=700,Zr="tooltip.open",[Ud,On]=rr(so),ro=r=>{const{__scopeTooltip:e,delayDuration:t=Ld,skipDelayDuration:s=300,disableHoverableContent:n=!1,children:i}=r,a=g.useRef(!0),l=g.useRef(!1),c=g.useRef(0);return g.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),o.jsx(Ud,{scope:e,isOpenDelayedRef:a,delayDuration:t,onOpen:g.useCallback(()=>{window.clearTimeout(c.current),a.current=!1},[]),onClose:g.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a.current=!0,s)},[s]),isPointerInTransitRef:l,onPointerInTransitChange:g.useCallback(d=>{l.current=d},[]),disableHoverableContent:n,children:i})};ro.displayName=so;var ir="Tooltip",[Fd,ar]=rr(ir),no=r=>{const{__scopeTooltip:e,children:t,open:s,defaultOpen:n=!1,onOpenChange:i,disableHoverableContent:a,delayDuration:l}=r,c=On(ir,r.__scopeTooltip),d=nr(e),[u,h]=g.useState(null),f=xl(),p=g.useRef(0),b=a??c.disableHoverableContent,v=l??c.delayDuration,m=g.useRef(!1),[x=!1,_]=mn({prop:s,defaultProp:n,onChange:O=>{O?(c.onOpen(),document.dispatchEvent(new CustomEvent(Zr))):c.onClose(),i==null||i(O)}}),w=g.useMemo(()=>x?m.current?"delayed-open":"instant-open":"closed",[x]),k=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,m.current=!1,_(!0)},[_]),A=g.useCallback(()=>{window.clearTimeout(p.current),p.current=0,_(!1)},[_]),C=g.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{m.current=!0,_(!0),p.current=0},v)},[v,_]);return g.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),o.jsx(_l,{...d,children:o.jsx(Fd,{scope:e,contentId:f,open:x,stateAttribute:w,trigger:u,onTriggerChange:h,onTriggerEnter:g.useCallback(()=>{c.isOpenDelayedRef.current?C():k()},[c.isOpenDelayedRef,C,k]),onTriggerLeave:g.useCallback(()=>{b?A():(window.clearTimeout(p.current),p.current=0)},[A,b]),onOpen:k,onClose:A,disableHoverableContent:b,children:t})})};no.displayName=ir;var en="TooltipTrigger",io=g.forwardRef((r,e)=>{const{__scopeTooltip:t,...s}=r,n=ar(en,t),i=On(en,t),a=nr(t),l=g.useRef(null),c=Ds(e,l,n.onTriggerChange),d=g.useRef(!1),u=g.useRef(!1),h=g.useCallback(()=>d.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),o.jsx(pl,{asChild:!0,...a,children:o.jsx(Pe.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...s,ref:c,onPointerMove:ge(r.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(n.onTriggerEnter(),u.current=!0)}),onPointerLeave:ge(r.onPointerLeave,()=>{n.onTriggerLeave(),u.current=!1}),onPointerDown:ge(r.onPointerDown,()=>{n.open&&n.onClose(),d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:ge(r.onFocus,()=>{d.current||n.onOpen()}),onBlur:ge(r.onBlur,n.onClose),onClick:ge(r.onClick,n.onClose)})})});io.displayName=en;var Bd="TooltipPortal",[Pg,qd]=rr(Bd,{forceMount:void 0}),os="TooltipContent",ao=g.forwardRef((r,e)=>{const t=qd(os,r.__scopeTooltip),{forceMount:s=t.forceMount,side:n="top",...i}=r,a=ar(os,r.__scopeTooltip);return o.jsx(yn,{present:s||a.open,children:a.disableHoverableContent?o.jsx(oo,{side:n,...i,ref:e}):o.jsx(Kd,{side:n,...i,ref:e})})}),Kd=g.forwardRef((r,e)=>{const t=ar(os,r.__scopeTooltip),s=On(os,r.__scopeTooltip),n=g.useRef(null),i=Ds(e,n),[a,l]=g.useState(null),{trigger:c,onClose:d}=t,u=n.current,{onPointerInTransitChange:h}=s,f=g.useCallback(()=>{l(null),h(!1)},[h]),p=g.useCallback((b,v)=>{const m=b.currentTarget,x={x:b.clientX,y:b.clientY},_=Gd(x,m.getBoundingClientRect()),w=Qd(x,_),k=Jd(v.getBoundingClientRect()),A=Xd([...w,...k]);l(A),h(!0)},[h]);return g.useEffect(()=>()=>f(),[f]),g.useEffect(()=>{if(c&&u){const b=m=>p(m,u),v=m=>p(m,c);return c.addEventListener("pointerleave",b),u.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",b),u.removeEventListener("pointerleave",v)}}},[c,u,p,f]),g.useEffect(()=>{if(a){const b=v=>{const m=v.target,x={x:v.clientX,y:v.clientY},_=(c==null?void 0:c.contains(m))||(u==null?void 0:u.contains(m)),w=!Yd(x,a);_?f():w&&(f(),d())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[c,u,a,d,f]),o.jsx(oo,{...r,ref:i})}),[zd,Wd]=rr(ir,{isInside:!1}),Vd=wl("TooltipContent"),oo=g.forwardRef((r,e)=>{const{__scopeTooltip:t,children:s,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:a,...l}=r,c=ar(os,t),d=nr(t),{onClose:u}=c;return g.useEffect(()=>(document.addEventListener(Zr,u),()=>document.removeEventListener(Zr,u)),[u]),g.useEffect(()=>{if(c.trigger){const h=f=>{const p=f.target;p!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,u]),o.jsx(ml,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:o.jsxs(yl,{"data-state":c.stateAttribute,...d,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(Vd,{children:s}),o.jsx(zd,{scope:t,isInside:!0,children:o.jsx(vl,{id:c.contentId,role:"tooltip",children:n||s})})]})})});ao.displayName=os;var lo="TooltipArrow",Hd=g.forwardRef((r,e)=>{const{__scopeTooltip:t,...s}=r,n=nr(t);return Wd(lo,t).isInside?null:o.jsx(bl,{...n,...s,ref:e})});Hd.displayName=lo;function Gd(r,e){const t=Math.abs(e.top-r.y),s=Math.abs(e.bottom-r.y),n=Math.abs(e.right-r.x),i=Math.abs(e.left-r.x);switch(Math.min(t,s,n,i)){case i:return"left";case n:return"right";case t:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function Qd(r,e,t=5){const s=[];switch(e){case"top":s.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":s.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":s.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":s.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return s}function Jd(r){const{top:e,right:t,bottom:s,left:n}=r;return[{x:n,y:e},{x:t,y:e},{x:t,y:s},{x:n,y:s}]}function Yd(r,e){const{x:t,y:s}=r;let n=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const l=e[i].x,c=e[i].y,d=e[a].x,u=e[a].y;c>s!=u>s&&t<(d-l)*(s-c)/(u-c)+l&&(n=!n)}return n}function Xd(r){const e=r.slice();return e.sort((t,s)=>t.x<s.x?-1:t.x>s.x?1:t.y<s.y?-1:t.y>s.y?1:0),Zd(e)}function Zd(r){if(r.length<=1)return r.slice();const e=[];for(let s=0;s<r.length;s++){const n=r[s];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(n.y-a.y)>=(i.y-a.y)*(n.x-a.x))e.pop();else break}e.push(n)}e.pop();const t=[];for(let s=r.length-1;s>=0;s--){const n=r[s];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(n.y-a.y)>=(i.y-a.y)*(n.x-a.x))t.pop();else break}t.push(n)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var eu=ro,tu=no,su=io,co=ao;const ru=eu,hi=tu,fi=su,tn=g.forwardRef(({className:r,sideOffset:e=4,...t},s)=>o.jsx(co,{ref:s,sideOffset:e,className:K("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",r),...t}));tn.displayName=co.displayName;const nu=sr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),se=g.forwardRef(({className:r,variant:e,size:t,asChild:s=!1,...n},i)=>{const a=s?kl:"button";return o.jsx(a,{className:K(nu({variant:e,size:t,className:r})),ref:i,...n})});se.displayName="Button";const Le=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("rounded-lg border bg-card text-card-foreground shadow-sm",r),...e}));Le.displayName="Card";const or=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("flex flex-col space-y-1.5 p-6",r),...e}));or.displayName="CardHeader";const lr=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("text-2xl font-semibold leading-none tracking-tight",r),...e}));lr.displayName="CardTitle";const An=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("text-sm text-muted-foreground",r),...e}));An.displayName="CardDescription";const Ve=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("p-6 pt-0",r),...e}));Ve.displayName="CardContent";const iu=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("flex items-center p-6 pt-0",r),...e}));iu.displayName="CardFooter";const uo="coworking-settings",Sr={currency:"BGN",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};function ho(){try{const r=localStorage.getItem(uo);if(r){const e=JSON.parse(r);return{...Sr,...e}}return Sr}catch(r){return console.error("Failed to load settings:",r),Sr}}function au(r){try{const t={...ho(),...r,updatedAt:new Date().toISOString()};localStorage.setItem(uo,JSON.stringify(t))}catch(e){throw console.error("Failed to save settings:",e),new Error("Failed to save settings to local storage")}}function fo(){return ho().currency}function ou(r){au({currency:r})}const Dt={USD:"$",EUR:"€",BGN:"лв"},gi={available:{className:"desk-available",icon:"check_circle",iconColor:"text-green-700",label:"Available"},booked:{className:"desk-booked",icon:"event_busy",iconColor:"text-orange-700",label:"Booked"},assigned:{className:"desk-assigned",icon:"person",iconColor:"text-blue-600",label:"Assigned"}};function lu({booking:r,onClick:e,isWeekend:t}){const s=(r==null?void 0:r.status)||"available",n=s==="unavailable"?"available":s,i=gi[n]||gi.available,a=n==="booked"&&(r==null?void 0:r.personName),l=n==="assigned"&&(r==null?void 0:r.personName),c=a||l;return t&&!c?o.jsxs("div",{className:"desk-cell rounded-lg p-2 min-h-[80px] bg-gray-100 cursor-not-allowed flex flex-col items-center justify-center text-center",style:{pointerEvents:"none"},children:[o.jsx("span",{className:"material-icon text-sm text-gray-400",children:"weekend"}),o.jsx("div",{className:"text-xs font-medium mt-1 text-gray-400",children:"Weekend"})]}):o.jsxs("div",{className:K("desk-cell rounded-lg p-2 min-h-[80px] flex flex-col items-center justify-center text-center",i.className,t&&"opacity-50 cursor-not-allowed"),onClick:d=>!t&&e(d),onContextMenu:d=>!t&&e(d),style:{pointerEvents:t?"none":"auto"},children:[o.jsx("span",{className:K("material-icon text-sm",i.iconColor),children:i.icon}),c?o.jsxs("div",{className:"mt-1",children:[o.jsx("div",{className:K("text-xs font-semibold",i.iconColor),children:r==null?void 0:r.personName}),(r==null?void 0:r.title)&&o.jsx("div",{className:K("text-[10px] leading-tight mt-0.5",i.iconColor),children:r.title.length>20?`${r.title.slice(0,20)}...`:r.title}),(r==null?void 0:r.price)&&o.jsxs("div",{className:K("text-[10px] font-medium mt-0.5",i.iconColor),children:[Dt[r.currency||"BGN"],r.price]})]}):o.jsx("div",{className:K("text-xs font-medium mt-1",i.iconColor),children:i.label})]})}const ds=El,cu=jl,go=g.forwardRef(({className:r,...e},t)=>o.jsx(Xi,{ref:t,className:K("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));go.displayName=Xi.displayName;const At=g.forwardRef(({className:r,children:e,...t},s)=>o.jsxs(cu,{children:[o.jsx(go,{}),o.jsxs(Zi,{ref:s,className:K("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,o.jsxs(Sl,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[o.jsx(Wa,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));At.displayName=Zi.displayName;const Pt=({className:r,...e})=>o.jsx("div",{className:K("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});Pt.displayName="DialogHeader";const Rt=g.forwardRef(({className:r,...e},t)=>o.jsx(ea,{ref:t,className:K("text-lg font-semibold leading-none tracking-tight",r),...e}));Rt.displayName=ea.displayName;const po=g.forwardRef(({className:r,...e},t)=>o.jsx(ta,{ref:t,className:K("text-sm text-muted-foreground",r),...e}));po.displayName=ta.displayName;const Ne=g.forwardRef(({className:r,type:e,...t},s)=>o.jsx("input",{type:e,className:K("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...t}));Ne.displayName="Input";var du="Label",mo=g.forwardRef((r,e)=>o.jsx(Pe.label,{...r,ref:e,onMouseDown:t=>{var n;t.target.closest("button, input, select, textarea")||((n=r.onMouseDown)==null||n.call(r,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));mo.displayName=du;var yo=mo;const uu=sr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fe=g.forwardRef(({className:r,...e},t)=>o.jsx(yo,{ref:t,className:K(uu(),r),...e}));fe.displayName=yo.displayName;const it=[{id:"room1-desk1",room:1,number:1,label:"Room 1, Desk 1"},{id:"room1-desk2",room:1,number:2,label:"Room 1, Desk 2"},{id:"room1-desk3",room:1,number:3,label:"Room 1, Desk 3"},{id:"room1-desk4",room:1,number:4,label:"Room 1, Desk 4"},{id:"room2-desk1",room:2,number:5,label:"Room 2, Desk 5"},{id:"room2-desk2",room:2,number:6,label:"Room 2, Desk 6"},{id:"room2-desk3",room:2,number:7,label:"Room 2, Desk 7"},{id:"room2-desk4",room:2,number:8,label:"Room 2, Desk 8"}];function hu({isOpen:r,onClose:e,booking:t,deskId:s,date:n,onSave:i}){const[a,l]=g.useState("");g.useEffect(()=>{r&&l((t==null?void 0:t.personName)||"")},[r,t]);const c=()=>{a.trim()&&(i(a.trim()),e())},d=f=>{f.key==="Enter"?c():f.key==="Escape"&&e()},u=it.find(f=>f.id===s),h=new Date(n).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"sm:max-w-md",children:[o.jsx(Pt,{children:o.jsxs(Rt,{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-blue-600",children:"person"}),"Assign Person to Desk"]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(fe,{className:"text-sm font-medium text-gray-700",children:"Desk Information"}),o.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[u==null?void 0:u.label," - ",h]})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"personName",className:"text-sm font-medium text-gray-700",children:"Person Name"}),o.jsx(Ne,{id:"personName",type:"text",value:a,onChange:f=>l(f.target.value),onKeyDown:d,placeholder:"Enter person's name",className:"mt-1",autoFocus:!0})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(se,{variant:"outline",onClick:e,children:"Cancel"}),o.jsx(se,{onClick:c,disabled:!a.trim(),className:"bg-blue-600 hover:bg-blue-700",children:"Save"})]})]})})}const Pn=g.forwardRef(({className:r,...e},t)=>o.jsx("textarea",{className:K("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...e}));Pn.displayName="Textarea";const Rn=Al,In=Pl,cr=g.forwardRef(({className:r,children:e,...t},s)=>o.jsxs(sa,{ref:s,className:K("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...t,children:[e,o.jsx(Cl,{asChild:!0,children:o.jsx(za,{className:"h-4 w-4 opacity-50"})})]}));cr.displayName=sa.displayName;const vo=g.forwardRef(({className:r,...e},t)=>o.jsx(ra,{ref:t,className:K("flex cursor-default items-center justify-center py-1",r),...e,children:o.jsx(zc,{className:"h-4 w-4"})}));vo.displayName=ra.displayName;const bo=g.forwardRef(({className:r,...e},t)=>o.jsx(na,{ref:t,className:K("flex cursor-default items-center justify-center py-1",r),...e,children:o.jsx(za,{className:"h-4 w-4"})}));bo.displayName=na.displayName;const dr=g.forwardRef(({className:r,children:e,position:t="popper",...s},n)=>o.jsx(Tl,{children:o.jsxs(ia,{ref:n,className:K("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...s,children:[o.jsx(vo,{}),o.jsx(Nl,{className:K("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),o.jsx(bo,{})]})}));dr.displayName=ia.displayName;const fu=g.forwardRef(({className:r,...e},t)=>o.jsx(aa,{ref:t,className:K("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...e}));fu.displayName=aa.displayName;const gt=g.forwardRef(({className:r,children:e,...t},s)=>o.jsxs(oa,{ref:s,className:K("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Dl,{children:o.jsx(Tn,{className:"h-4 w-4"})})}),o.jsx(Ol,{children:e})]}));gt.displayName=oa.displayName;const gu=g.forwardRef(({className:r,...e},t)=>o.jsx(la,{ref:t,className:K("-mx-1 my-1 h-px bg-muted",r),...e}));gu.displayName=la.displayName;function pu({isOpen:r,onClose:e,booking:t,deskId:s,date:n,currency:i,onSave:a}){const[l,c]=g.useState(""),[d,u]=g.useState(""),[h,f]=g.useState(""),[p,b]=g.useState("assigned"),[v,m]=g.useState(""),[x,_]=g.useState(""),[w,k]=g.useState("");g.useEffect(()=>{var T;r&&(c((t==null?void 0:t.personName)||""),u((t==null?void 0:t.title)||""),f(((T=t==null?void 0:t.price)==null?void 0:T.toString())||"15"),b((t==null?void 0:t.status)||"assigned"),m((t==null?void 0:t.startDate)||n),_((t==null?void 0:t.endDate)||n),k(""))},[r,t,n]);const A=async()=>{const T=l.trim(),$=d.trim(),le=parseFloat(h);if(T&&le>=0&&v&&x)try{k(""),await a({personName:T,title:$,price:le,status:p,startDate:v,endDate:x,currency:i}),e()}catch(S){S.message&&S.message.includes("conflict")?k(S.message):k("An error occurred while saving the booking.")}},C=T=>{T.key==="Enter"&&T.ctrlKey?A():T.key==="Escape"&&e()},O=it.find(T=>T.id===s),q=(T=>{if(!T)return"Invalid Date";try{const $=new Date(T+"T00:00:00");return isNaN($.getTime())?T:$.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch($){return console.error("Date formatting error:",$),T}})(n),G=l.trim()&&h.trim()&&!isNaN(parseFloat(h))&&parseFloat(h)>=0&&v&&x&&v<=x;return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"sm:max-w-md",children:[o.jsx(Pt,{children:o.jsxs(Rt,{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-blue-600",children:"event_seat"}),"Book Desk"]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[o.jsx(fe,{className:"text-sm font-medium text-blue-900",children:"Desk Information"}),o.jsxs("p",{className:"text-sm text-blue-800 mt-1",children:[O==null?void 0:O.label," - ",q]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"startDate",className:"text-sm font-medium text-gray-700",children:"Start Date *"}),o.jsx(Ne,{id:"startDate",type:"date",value:v,onChange:T=>m(T.target.value),className:"mt-1",required:!0})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"endDate",className:"text-sm font-medium text-gray-700",children:"End Date *"}),o.jsx(Ne,{id:"endDate",type:"date",value:x,onChange:T=>_(T.target.value),min:v,className:"mt-1",required:!0})]})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"personName",className:"text-sm font-medium text-gray-700",children:"Name *"}),o.jsx(Ne,{id:"personName",type:"text",value:l,onChange:T=>c(T.target.value.slice(0,20)),onKeyDown:C,placeholder:"Enter name",maxLength:20,className:"mt-1",autoFocus:!0}),o.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.length,"/20 characters"]})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"title",className:"text-sm font-medium text-gray-700",children:"Booking Title/Purpose (Optional)"}),o.jsx(Pn,{id:"title",value:d,onChange:T=>u(T.target.value),onKeyDown:C,placeholder:"e.g., Team meeting, Individual work, Client presentation...",className:"mt-1 resize-none",rows:2})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"status",className:"text-sm font-medium text-gray-700",children:"Booking Status *"}),o.jsxs(Rn,{value:p,onValueChange:T=>b(T),children:[o.jsx(cr,{className:"mt-1",children:o.jsx(In,{})}),o.jsxs(dr,{children:[o.jsx(gt,{value:"booked",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-orange-600 text-sm",children:"event_busy"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:"Booked"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Reserved but not paid"})]})]})}),o.jsx(gt,{value:"assigned",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-blue-600 text-sm",children:"person"}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:"Assigned (Paid)"}),o.jsx("div",{className:"text-xs text-gray-500",children:"Paid and confirmed"})]})]})})]})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Choose "Booked" for reservations or "Assigned" for paid bookings'})]}),o.jsxs("div",{children:[o.jsxs(fe,{htmlFor:"price",className:"text-sm font-medium text-gray-700",children:["Price (",Dt[i],") *"]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:Dt[i]}),o.jsx(Ne,{id:"price",type:"number",value:h,onChange:T=>f(T.target.value),onKeyDown:C,placeholder:"15.00",min:"0",step:"0.01",className:"pl-8"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the total price for this booking"})]}),w&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("span",{className:"material-icon text-red-500 text-lg mr-2 mt-0.5",children:"error"}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Booking Conflict"}),o.jsx("p",{className:"text-sm text-red-700 mt-1 whitespace-pre-line",children:w})]})]})})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(se,{variant:"outline",onClick:e,children:"Cancel"}),o.jsxs(se,{onClick:A,disabled:!G,className:"bg-blue-600 hover:bg-blue-700",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"check"}),"Book Desk"]})]}),o.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Tip: Press Ctrl+Enter to save quickly"})]})})}var $n="Checkbox",[mu,Rg]=Xs($n),[yu,vu]=mu($n),wo=g.forwardRef((r,e)=>{const{__scopeCheckbox:t,name:s,checked:n,defaultChecked:i,required:a,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=r,[f,p]=g.useState(null),b=Ds(e,k=>p(k)),v=g.useRef(!1),m=f?u||!!f.closest("form"):!0,[x=!1,_]=mn({prop:n,defaultProp:i,onChange:d}),w=g.useRef(x);return g.useEffect(()=>{const k=f==null?void 0:f.form;if(k){const A=()=>_(w.current);return k.addEventListener("reset",A),()=>k.removeEventListener("reset",A)}},[f,_]),o.jsxs(yu,{scope:t,state:x,disabled:l,children:[o.jsx(Pe.button,{type:"button",role:"checkbox","aria-checked":pt(x)?"mixed":x,"aria-required":a,"data-state":ko(x),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:b,onKeyDown:ge(r.onKeyDown,k=>{k.key==="Enter"&&k.preventDefault()}),onClick:ge(r.onClick,k=>{_(A=>pt(A)?!0:!A),m&&(v.current=k.isPropagationStopped(),v.current||k.stopPropagation())})}),m&&o.jsx(bu,{control:f,bubbles:!v.current,name:s,value:c,checked:x,required:a,disabled:l,form:u,style:{transform:"translateX(-100%)"},defaultChecked:pt(i)?!1:i})]})});wo.displayName=$n;var xo="CheckboxIndicator",_o=g.forwardRef((r,e)=>{const{__scopeCheckbox:t,forceMount:s,...n}=r,i=vu(xo,t);return o.jsx(yn,{present:s||pt(i.state)||i.state===!0,children:o.jsx(Pe.span,{"data-state":ko(i.state),"data-disabled":i.disabled?"":void 0,...n,ref:e,style:{pointerEvents:"none",...r.style}})})});_o.displayName=xo;var bu=r=>{const{control:e,checked:t,bubbles:s=!0,defaultChecked:n,...i}=r,a=g.useRef(null),l=Rl(t),c=Il(e);g.useEffect(()=>{const u=a.current,h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==t&&p){const b=new Event("click",{bubbles:s});u.indeterminate=pt(t),p.call(u,pt(t)?!1:t),u.dispatchEvent(b)}},[l,t,s]);const d=g.useRef(pt(t)?!1:t);return o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??d.current,...i,tabIndex:-1,ref:a,style:{...r.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function pt(r){return r==="indeterminate"}function ko(r){return pt(r)?"indeterminate":r?"checked":"unchecked"}var So=wo,wu=_o;const Mn=g.forwardRef(({className:r,...e},t)=>o.jsx(So,{ref:t,className:K("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...e,children:o.jsx(wu,{className:K("flex items-center justify-center text-current"),children:o.jsx(Tn,{className:"h-4 w-4"})})}));Mn.displayName=So.displayName;var jo={exports:{}};(function(r,e){(function(t,s){r.exports=s()})(_e,function(){var t=1e3,s=6e4,n=36e5,i="millisecond",a="second",l="minute",c="hour",d="day",u="week",h="month",f="quarter",p="year",b="date",v="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(S){var E=["th","st","nd","rd"],j=S%100;return"["+S+(E[(j-20)%10]||E[j]||E[0])+"]"}},w=function(S,E,j){var P=String(S);return!P||P.length>=E?S:""+Array(E+1-P.length).join(j)+S},k={s:w,z:function(S){var E=-S.utcOffset(),j=Math.abs(E),P=Math.floor(j/60),N=j%60;return(E<=0?"+":"-")+w(P,2,"0")+":"+w(N,2,"0")},m:function S(E,j){if(E.date()<j.date())return-S(j,E);var P=12*(j.year()-E.year())+(j.month()-E.month()),N=E.clone().add(P,h),I=j-N<0,L=E.clone().add(P+(I?-1:1),h);return+(-(P+(j-N)/(I?N-L:L-N))||0)},a:function(S){return S<0?Math.ceil(S)||0:Math.floor(S)},p:function(S){return{M:h,y:p,w:u,d,D:b,h:c,m:l,s:a,ms:i,Q:f}[S]||String(S||"").toLowerCase().replace(/s$/,"")},u:function(S){return S===void 0}},A="en",C={};C[A]=_;var O="$isDayjsObject",V=function(S){return S instanceof $||!(!S||!S[O])},q=function S(E,j,P){var N;if(!E)return A;if(typeof E=="string"){var I=E.toLowerCase();C[I]&&(N=I),j&&(C[I]=j,N=I);var L=E.split("-");if(!N&&L.length>1)return S(L[0])}else{var H=E.name;C[H]=E,N=H}return!P&&N&&(A=N),N||!P&&A},G=function(S,E){if(V(S))return S.clone();var j=typeof E=="object"?E:{};return j.date=S,j.args=arguments,new $(j)},T=k;T.l=q,T.i=V,T.w=function(S,E){return G(S,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var $=function(){function S(j){this.$L=q(j.locale,null,!0),this.parse(j),this.$x=this.$x||j.x||{},this[O]=!0}var E=S.prototype;return E.parse=function(j){this.$d=function(P){var N=P.date,I=P.utc;if(N===null)return new Date(NaN);if(T.u(N))return new Date;if(N instanceof Date)return new Date(N);if(typeof N=="string"&&!/Z$/i.test(N)){var L=N.match(m);if(L){var H=L[2]-1||0,Z=(L[7]||"0").substring(0,3);return I?new Date(Date.UTC(L[1],H,L[3]||1,L[4]||0,L[5]||0,L[6]||0,Z)):new Date(L[1],H,L[3]||1,L[4]||0,L[5]||0,L[6]||0,Z)}}return new Date(N)}(j),this.init()},E.init=function(){var j=this.$d;this.$y=j.getFullYear(),this.$M=j.getMonth(),this.$D=j.getDate(),this.$W=j.getDay(),this.$H=j.getHours(),this.$m=j.getMinutes(),this.$s=j.getSeconds(),this.$ms=j.getMilliseconds()},E.$utils=function(){return T},E.isValid=function(){return this.$d.toString()!==v},E.isSame=function(j,P){var N=G(j);return this.startOf(P)<=N&&N<=this.endOf(P)},E.isAfter=function(j,P){return G(j)<this.startOf(P)},E.isBefore=function(j,P){return this.endOf(P)<G(j)},E.$g=function(j,P,N){return T.u(j)?this[P]:this.set(N,j)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(j,P){var N=this,I=!!T.u(P)||P,L=T.p(j),H=function(He,be){var Be=T.w(N.$u?Date.UTC(N.$y,be,He):new Date(N.$y,be,He),N);return I?Be:Be.endOf(d)},Z=function(He,be){return T.w(N.toDate()[He].apply(N.toDate("s"),(I?[0,0,0,0]:[23,59,59,999]).slice(be)),N)},ee=this.$W,ie=this.$M,ve=this.$D,Ze="set"+(this.$u?"UTC":"");switch(L){case p:return I?H(1,0):H(31,11);case h:return I?H(1,ie):H(0,ie+1);case u:var Re=this.$locale().weekStart||0,yt=(ee<Re?ee+7:ee)-Re;return H(I?ve-yt:ve+(6-yt),ie);case d:case b:return Z(Ze+"Hours",0);case c:return Z(Ze+"Minutes",1);case l:return Z(Ze+"Seconds",2);case a:return Z(Ze+"Milliseconds",3);default:return this.clone()}},E.endOf=function(j){return this.startOf(j,!1)},E.$set=function(j,P){var N,I=T.p(j),L="set"+(this.$u?"UTC":""),H=(N={},N[d]=L+"Date",N[b]=L+"Date",N[h]=L+"Month",N[p]=L+"FullYear",N[c]=L+"Hours",N[l]=L+"Minutes",N[a]=L+"Seconds",N[i]=L+"Milliseconds",N)[I],Z=I===d?this.$D+(P-this.$W):P;if(I===h||I===p){var ee=this.clone().set(b,1);ee.$d[H](Z),ee.init(),this.$d=ee.set(b,Math.min(this.$D,ee.daysInMonth())).$d}else H&&this.$d[H](Z);return this.init(),this},E.set=function(j,P){return this.clone().$set(j,P)},E.get=function(j){return this[T.p(j)]()},E.add=function(j,P){var N,I=this;j=Number(j);var L=T.p(P),H=function(ie){var ve=G(I);return T.w(ve.date(ve.date()+Math.round(ie*j)),I)};if(L===h)return this.set(h,this.$M+j);if(L===p)return this.set(p,this.$y+j);if(L===d)return H(1);if(L===u)return H(7);var Z=(N={},N[l]=s,N[c]=n,N[a]=t,N)[L]||1,ee=this.$d.getTime()+j*Z;return T.w(ee,this)},E.subtract=function(j,P){return this.add(-1*j,P)},E.format=function(j){var P=this,N=this.$locale();if(!this.isValid())return N.invalidDate||v;var I=j||"YYYY-MM-DDTHH:mm:ssZ",L=T.z(this),H=this.$H,Z=this.$m,ee=this.$M,ie=N.weekdays,ve=N.months,Ze=N.meridiem,Re=function(be,Be,vt,D){return be&&(be[Be]||be(P,I))||vt[Be].slice(0,D)},yt=function(be){return T.s(H%12||12,be,"0")},He=Ze||function(be,Be,vt){var D=be<12?"AM":"PM";return vt?D.toLowerCase():D};return I.replace(x,function(be,Be){return Be||function(vt){switch(vt){case"YY":return String(P.$y).slice(-2);case"YYYY":return T.s(P.$y,4,"0");case"M":return ee+1;case"MM":return T.s(ee+1,2,"0");case"MMM":return Re(N.monthsShort,ee,ve,3);case"MMMM":return Re(ve,ee);case"D":return P.$D;case"DD":return T.s(P.$D,2,"0");case"d":return String(P.$W);case"dd":return Re(N.weekdaysMin,P.$W,ie,2);case"ddd":return Re(N.weekdaysShort,P.$W,ie,3);case"dddd":return ie[P.$W];case"H":return String(H);case"HH":return T.s(H,2,"0");case"h":return yt(1);case"hh":return yt(2);case"a":return He(H,Z,!0);case"A":return He(H,Z,!1);case"m":return String(Z);case"mm":return T.s(Z,2,"0");case"s":return String(P.$s);case"ss":return T.s(P.$s,2,"0");case"SSS":return T.s(P.$ms,3,"0");case"Z":return L}return null}(be)||L.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(j,P,N){var I,L=this,H=T.p(P),Z=G(j),ee=(Z.utcOffset()-this.utcOffset())*s,ie=this-Z,ve=function(){return T.m(L,Z)};switch(H){case p:I=ve()/12;break;case h:I=ve();break;case f:I=ve()/3;break;case u:I=(ie-ee)/6048e5;break;case d:I=(ie-ee)/864e5;break;case c:I=ie/n;break;case l:I=ie/s;break;case a:I=ie/t;break;default:I=ie}return N?I:T.a(I)},E.daysInMonth=function(){return this.endOf(h).$D},E.$locale=function(){return C[this.$L]},E.locale=function(j,P){if(!j)return this.$L;var N=this.clone(),I=q(j,P,!0);return I&&(N.$L=I),N},E.clone=function(){return T.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},S}(),le=$.prototype;return G.prototype=le,[["$ms",i],["$s",a],["$m",l],["$H",c],["$W",d],["$M",h],["$y",p],["$D",b]].forEach(function(S){le[S[1]]=function(E){return this.$g(E,S[0],S[1])}}),G.extend=function(S,E){return S.$i||(S(E,$,G),S.$i=!0),G},G.locale=q,G.isDayjs=V,G.unix=function(S){return G(1e3*S)},G.en=C[A],G.Ls=C,G.p={},G})})(jo);var xu=jo.exports;const he=Zs(xu);var Eo={exports:{}};(function(r,e){(function(t,s){r.exports=s()})(_e,function(){var t="week",s="year";return function(n,i,a){var l=i.prototype;l.week=function(c){if(c===void 0&&(c=null),c!==null)return this.add(7*(c-this.week()),"day");var d=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var u=a(this).startOf(s).add(1,s).date(d),h=a(this).endOf(t);if(u.isBefore(h))return 1}var f=a(this).startOf(s).date(d).startOf(t).subtract(1,"millisecond"),p=this.diff(f,t,!0);return p<0?a(this).startOf("week").week():Math.ceil(p)},l.weeks=function(c){return c===void 0&&(c=null),this.week(c)}}})})(Eo);var _u=Eo.exports;const ku=Zs(_u);var Co={exports:{}};(function(r,e){(function(t,s){r.exports=s()})(_e,function(){var t="day";return function(s,n,i){var a=function(d){return d.add(4-d.isoWeekday(),t)},l=n.prototype;l.isoWeekYear=function(){return a(this).year()},l.isoWeek=function(d){if(!this.$utils().u(d))return this.add(7*(d-this.isoWeek()),t);var u,h,f,p,b=a(this),v=(u=this.isoWeekYear(),h=this.$u,f=(h?i.utc:i)().year(u).startOf("year"),p=4-f.isoWeekday(),f.isoWeekday()>4&&(p+=7),f.add(p,t));return b.diff(v,"week")+1},l.isoWeekday=function(d){return this.$utils().u(d)?this.day()||7:this.day(this.day()%7?d:d-7)};var c=l.startOf;l.startOf=function(d,u){var h=this.$utils(),f=!!h.u(u)||u;return h.p(d)==="isoweek"?f?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):c.bind(this)(d,u)}}})})(Co);var Su=Co.exports;const ju=Zs(Su);var To={exports:{}};(function(r,e){(function(t,s){r.exports=s()})(_e,function(){return function(t,s){s.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})(To);var Eu=To.exports;const Cu=Zs(Eu);he.extend(ku);he.extend(ju);he.extend(Cu);function No(r=0){const t=he().add(r,"week").startOf("isoWeek"),s=[];for(let n=0;n<7;n++){const i=t.add(n,"day");s.push({date:i,dayName:i.format("ddd"),fullDate:i.format("MMM D"),dateString:i.format("YYYY-MM-DD")})}return s}function Tu(r=0){const e=he().add(r,"month"),t=e.startOf("month"),s=e.endOf("month"),n=[];let i=t;for(;i.isSameOrBefore(s,"day");)n.push({date:i,dayName:i.format("ddd"),fullDate:i.format("MMM D"),dateString:i.format("YYYY-MM-DD"),isCurrentMonth:i.isSame(e,"month")}),i=i.add(1,"day");return n}function Nu(r=0){const e=No(r),t=e[0],s=e[6];return t.date.month()===s.date.month()?`${t.date.format("MMMM D")}-${s.date.format("D, YYYY")}`:`${t.date.format("MMM D")} - ${s.date.format("MMM D, YYYY")}`}function Du(r=0){return he().add(r,"month").format("MMMM YYYY")}function Ou(r,e){const t=he(r),s=he(e);return t.isSame(s,"day")?t.format("MMM D, YYYY"):t.isSame(s,"month")?`${t.format("MMM D")}-${s.format("D, YYYY")}`:`${t.format("MMM D")} - ${s.format("MMM D, YYYY")}`}function pi(r,e){const t=he(r),s=he(e),n=[];let i=t;for(;i.isBefore(s)||i.isSame(s,"day");)n.push(i.format("YYYY-MM-DD")),i=i.add(1,"day");return n}function Au({isOpen:r,onClose:e,onApply:t}){const[s,n]=g.useState(""),[i,a]=g.useState(""),[l,c]=g.useState([]),[d,u]=g.useState("available");g.useEffect(()=>{if(r){const m=he().format("YYYY-MM-DD"),x=he().add(7,"day").format("YYYY-MM-DD");n(m),a(x),c([]),u("available")}},[r]);const h=(m,x)=>{c(_=>x?[..._,m]:_.filter(w=>w!==m))},f=()=>{l.length===it.length?c([]):c(it.map(m=>m.id))},p=()=>{!s||!i||l.length===0||he(s).isAfter(he(i))||(t(s,i,l,d),e())},b=s&&i&&l.length>0&&(he(s).isSame(he(i))||he(s).isBefore(he(i))),v=s&&i?Ou(s,i):"";return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"sm:max-w-lg",children:[o.jsx(Pt,{children:o.jsxs(Rt,{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-blue-600",children:"date_range"}),"Set Desk Availability Range"]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"startDate",className:"text-sm font-medium text-gray-700",children:"Start Date"}),o.jsx(Ne,{id:"startDate",type:"date",value:s,onChange:m=>n(m.target.value),className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"endDate",className:"text-sm font-medium text-gray-700",children:"End Date"}),o.jsx(Ne,{id:"endDate",type:"date",value:i,onChange:m=>a(m.target.value),min:s,className:"mt-1"})]})]}),v&&o.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:[o.jsx("strong",{children:"Date Range:"})," ",v]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs(fe,{className:"text-sm font-medium text-gray-700",children:["Select Desks (",l.length," of ",it.length," selected)"]}),o.jsx(se,{type:"button",variant:"outline",size:"sm",onClick:f,children:l.length===it.length?"Deselect All":"Select All"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border rounded p-2",children:it.map(m=>o.jsxs("label",{className:"flex items-center p-2 rounded border hover:bg-gray-50 cursor-pointer",children:[o.jsx(Mn,{checked:l.includes(m.id),onCheckedChange:x=>h(m.id,!!x),className:"mr-2"}),o.jsx("span",{className:"text-sm",children:m.label})]},m.id))})]}),o.jsxs("div",{children:[o.jsx(fe,{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Status"}),o.jsxs(Rn,{value:d,onValueChange:m=>u(m),children:[o.jsx(cr,{children:o.jsx(In,{})}),o.jsxs(dr,{children:[o.jsx(gt,{value:"available",children:"Available"}),o.jsx(gt,{value:"booked",children:"Booked"})]})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(se,{variant:"outline",onClick:e,children:"Cancel"}),o.jsx(se,{onClick:p,disabled:!b,className:"bg-blue-600 hover:bg-blue-700",children:"Apply"})]})]})})}function Pu({isOpen:r,onClose:e}){return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"max-w-5xl w-[90vw] max-h-[90vh] p-4",children:[o.jsx(Pt,{className:"mb-4",children:o.jsx(Rt,{className:"text-lg font-semibold",children:"Coworking Space Floor Plan"})}),o.jsx("div",{className:"flex items-center justify-center overflow-auto",style:{height:"calc(90vh - 100px)"},children:o.jsx("img",{src:"/DeskPlanner/plan.jpeg",alt:"Coworking Space Floor Plan",className:"w-auto h-auto max-w-full max-h-full object-contain rounded-md shadow-lg",style:{minWidth:"400px",minHeight:"300px"}})})]})})}const Ru="modulepreload",Iu=function(r){return"/DeskPlanner/"+r},mi={},As=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map(c=>{if(c=Iu(c),c in mi)return;mi[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Ru,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return n.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},$u=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>As(async()=>{const{default:s}=await Promise.resolve().then(()=>us);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Ln extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Mu extends Ln{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class yi extends Ln{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class vi extends Ln{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var sn;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(sn||(sn={}));var Lu=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class Uu{constructor(e,{headers:t={},customFetch:s,region:n=sn.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=$u(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Lu(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(l["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(l["Content-Type"]="application/json",u=JSON.stringify(a)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:u}).catch(v=>{throw new Mu(v)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new yi(h);if(!h.ok)throw new vi(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),b;return p==="application/json"?b=yield h.json():p==="application/octet-stream"?b=yield h.blob():p==="text/event-stream"?b=h:p==="multipart/form-data"?b=yield h.formData():b=yield h.text(),{data:b,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof vi||n instanceof yi?n.context:void 0}}})}}var Ce={},Un={},ur={},Ps={},hr={},fr={},Fu=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ls=Fu();const Bu=ls.fetch,Do=ls.fetch.bind(ls),Oo=ls.Headers,qu=ls.Request,Ku=ls.Response,us=Object.freeze(Object.defineProperty({__proto__:null,Headers:Oo,Request:qu,Response:Ku,default:Do,fetch:Bu},Symbol.toStringTag,{value:"Module"})),zu=$l(us);var gr={};Object.defineProperty(gr,"__esModule",{value:!0});let Wu=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};gr.default=Wu;var Ao=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fr,"__esModule",{value:!0});const Vu=Ao(zu),Hu=Ao(gr);let Gu=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Vu.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,c;let d=null,u=null,h=null,f=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const v=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),m=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&m&&m.length>1&&(h=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,f=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const v=await i.text();try{d=JSON.parse(v),Array.isArray(d)&&i.status===404&&(u=[],d=null,f=200,p="OK")}catch{i.status===404&&v===""?(f=204,p="No Content"):d={message:v}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,f=200,p="OK"),d&&this.shouldThrowOnError)throw new Hu.default(d)}return{error:d,data:u,count:h,status:f,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var a,l,c;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}};fr.default=Gu;var Qu=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hr,"__esModule",{value:!0});const Ju=Qu(fr);let Yu=class extends Ju.default{select(e){let t=!1;const s=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const n=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:n=s}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};hr.default=Yu;var Xu=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ps,"__esModule",{value:!0});const Zu=Xu(hr);let eh=class extends Zu.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Ps.default=eh;var th=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ur,"__esModule",{value:!0});const ps=th(Ps);let sh=class{constructor(e,{headers:t={},schema:s,fetch:n}){this.url=e,this.headers=t,this.schema=s,this.fetch=n}select(e,{head:t=!1,count:s}={}){const n=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new ps.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ps.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:i=!0}={}){const a="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new ps.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new ps.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new ps.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};ur.default=sh;var pr={},mr={};Object.defineProperty(mr,"__esModule",{value:!0});mr.version=void 0;mr.version="0.0.0-automated";Object.defineProperty(pr,"__esModule",{value:!0});pr.DEFAULT_HEADERS=void 0;const rh=mr;pr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${rh.version}`};var Po=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Un,"__esModule",{value:!0});const nh=Po(ur),ih=Po(Ps),ah=pr;let oh=class Ro{constructor(e,{headers:t={},schema:s,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},ah.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new nh.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Ro(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:n=!1,count:i}={}){let a;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(a=s?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(a="POST",c=t);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new ih.default({method:a,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Un.default=oh;var hs=_e&&_e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.PostgrestError=Ce.PostgrestBuilder=Ce.PostgrestTransformBuilder=Ce.PostgrestFilterBuilder=Ce.PostgrestQueryBuilder=Ce.PostgrestClient=void 0;const Io=hs(Un);Ce.PostgrestClient=Io.default;const $o=hs(ur);Ce.PostgrestQueryBuilder=$o.default;const Mo=hs(Ps);Ce.PostgrestFilterBuilder=Mo.default;const Lo=hs(hr);Ce.PostgrestTransformBuilder=Lo.default;const Uo=hs(fr);Ce.PostgrestBuilder=Uo.default;const Fo=hs(gr);Ce.PostgrestError=Fo.default;var lh=Ce.default={PostgrestClient:Io.default,PostgrestQueryBuilder:$o.default,PostgrestFilterBuilder:Mo.default,PostgrestTransformBuilder:Lo.default,PostgrestBuilder:Uo.default,PostgrestError:Fo.default};const{PostgrestClient:ch,PostgrestQueryBuilder:Fg,PostgrestFilterBuilder:Bg,PostgrestTransformBuilder:qg,PostgrestBuilder:Kg,PostgrestError:zg}=lh;class dh{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const uh="2.15.1",hh=`realtime-js/${uh}`,fh="1.0.0",rn=1e4,gh=1e3,ph=100;var bs;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(bs||(bs={}));var ce;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(ce||(ce={}));var Ue;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(Ue||(Ue={}));var nn;(function(r){r.websocket="websocket"})(nn||(nn={}));var _t;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(_t||(_t={}));class mh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const l=s.decode(e.slice(a,a+n));a=a+n;const c=s.decode(e.slice(a,a+i));a=a+i;const d=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Bo{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var te;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(te||(te={}));const bi=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=yh(a,r,e,n),i),{})},yh=(r,e,t,s)=>{const n=e.find(l=>l.name===r),i=n==null?void 0:n.type,a=t[r];return i&&!s.includes(i)?qo(i,a):an(a)},qo=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return xh(e,t)}switch(r){case te.bool:return vh(e);case te.float4:case te.float8:case te.int2:case te.int4:case te.int8:case te.numeric:case te.oid:return bh(e);case te.json:case te.jsonb:return wh(e);case te.timestamp:return _h(e);case te.abstime:case te.date:case te.daterange:case te.int4range:case te.int8range:case te.money:case te.reltime:case te.text:case te.time:case te.timestamptz:case te.timetz:case te.tsrange:case te.tstzrange:return an(e);default:return an(e)}},an=r=>r,vh=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},bh=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},wh=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},xh=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>qo(e,l))}return r},_h=r=>typeof r=="string"?r.replace(" ","T"):r,Ko=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class jr{constructor(e,t,s={},n=rn){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var wi;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(wi||(wi={}));class ws{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ws.syncState(this.state,n,i,a),this.pendingDiffs.forEach(c=>{this.state=ws.syncDiff(this.state,c,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ws.syncDiff(this.state,n,i,a),l())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),l={},c={};return this.map(i,(d,u)=>{a[d]||(c[d]=u)}),this.map(a,(d,u)=>{const h=i[d];if(h){const f=u.map(m=>m.presence_ref),p=h.map(m=>m.presence_ref),b=u.filter(m=>p.indexOf(m.presence_ref)<0),v=h.filter(m=>f.indexOf(m.presence_ref)<0);b.length>0&&(l[d]=b),v.length>0&&(c[d]=v)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}s(l,u,c)}),this.map(a,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var xi;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(xi||(xi={}));var xs;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(xs||(xs={}));var Ye;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ye||(Ye={}));class Fn{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=ce.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new jr(this,Ue.join,this.params,this.timeout),this.rejoinTimer=new Bo(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ce.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ce.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ue.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ws(this),this.broadcastEndpointURL=Ko(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.state==ce.closed){const{config:{broadcast:i,presence:a,private:l}}=this.params,c=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(f=>f.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[xs.PRESENCE]&&this.bindings[xs.PRESENCE].length>0,u={},h={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(f=>e==null?void 0:e(Ye.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(Ye.CLOSED)),this.updateJoinPayload(Object.assign({config:h},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var p;if(this.socket.setAuth(),f===void 0){e==null||e(Ye.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,v=(p=b==null?void 0:b.length)!==null&&p!==void 0?p:0,m=[];for(let x=0;x<v;x++){const _=b[x],{filter:{event:w,schema:k,table:A,filter:C}}=_,O=f&&f[x];if(O&&O.event===w&&O.schema===k&&O.table===A&&O.filter===C)m.push(Object.assign(Object.assign({},_),{id:O.id}));else{this.unsubscribe(),this.state=ce.errored,e==null||e(Ye.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Ye.SUBSCRIBED);return}}).receive("error",f=>{this.state=ce.errored,e==null||e(Ye.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ye.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===ce.joined&&e===xs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ce.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ue.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new jr(this,Ue.leave,{},e),s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ce.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new jr(this,e,t,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ph){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Ue;if(s&&[l,c,d,u].indexOf(a)>=0&&s!==this._joinRef())return;let f=this._onMessage(a,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var b,v,m;return((b=p.filter)===null||b===void 0?void 0:b.event)==="*"||((m=(v=p.filter)===null||v===void 0?void 0:v.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(p=>p.callback(f,s)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var b,v,m,x,_,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const k=p.id,A=(b=p.filter)===null||b===void 0?void 0:b.event;return k&&((v=t.ids)===null||v===void 0?void 0:v.includes(k))&&(A==="*"||(A==null?void 0:A.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const k=(_=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return k==="*"||k===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const b=f.data,{schema:v,table:m,commit_timestamp:x,type:_,errors:w}=b;f=Object.assign(Object.assign({},{schema:v,table:m,commit_timestamp:x,eventType:_,new:{},old:{},errors:w}),this._getPayloadRecords(b))}p.callback(f,s)})}_isClosed(){return this.state===ce.closed}_isJoined(){return this.state===ce.joined}_isJoining(){return this.state===ce.joining}_isLeaving(){return this.state===ce.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Fn.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ue.close,{},e)}_onError(e){this._on(Ue.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ce.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=bi(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=bi(e.columns,e.old_record)),t}}const _i=()=>{},Ls={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},kh=[1e3,2e3,5e3,1e4],Sh=1e4,jh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Eh{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=rn,this.transport=null,this.heartbeatIntervalMs=Ls.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_i,this.ref=0,this.reconnectTimer=null,this.logger=_i,this.conn=null,this.sendBuffer=[],this.serializer=new mh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...a)=>As(async()=>{const{default:l}=await Promise.resolve().then(()=>us);return{default:l}},void 0).then(({default:l})=>l(...a)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${nn.websocket}`,this.httpEndpoint=Ko(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=dh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fh}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case bs.connecting:return _t.Connecting;case bs.open:return _t.Open;case bs.closing:return _t.Closing;default:return _t.Closed}}isConnected(){return this.connectionState()===_t.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new Fn(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(gh,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ls.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:i,ref:a}=t,l=a?`(${a})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ue.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([jh],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const n={access_token:t,version:hh};t&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ue.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Bo(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ls.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,n,i,a,l,c,d;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:rn,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:Ls.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:u=>kh[u-1]||Sh,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(u,h)=>h(JSON.stringify(u)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Bn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ue(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Ch extends Bn{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class on extends Bn{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Th=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const zo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>As(async()=>{const{default:s}=await Promise.resolve().then(()=>us);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Nh=()=>Th(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield As(()=>Promise.resolve().then(()=>us),void 0)).Response:Response}),ln=r=>{if(Array.isArray(r))return r.map(t=>ln(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=ln(s)}),e},Dh=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var It=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Er=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Oh=(r,e,t)=>It(void 0,void 0,void 0,function*(){const s=yield Nh();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{const i=r.status||500,a=(n==null?void 0:n.statusCode)||i+"";e(new Ch(Er(n),i,a))}).catch(n=>{e(new on(Er(n),n))}):e(new on(Er(r),r))}),Ah=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!s?n:(Dh(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),t))};function Rs(r,e,t,s,n,i){return It(this,void 0,void 0,function*(){return new Promise((a,l)=>{r(t,Ah(e,s,n,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>a(c)).catch(c=>Oh(c,l,s))})})}function Hs(r,e,t,s){return It(this,void 0,void 0,function*(){return Rs(r,"GET",e,t,s)})}function Xe(r,e,t,s,n){return It(this,void 0,void 0,function*(){return Rs(r,"POST",e,s,n,t)})}function cn(r,e,t,s,n){return It(this,void 0,void 0,function*(){return Rs(r,"PUT",e,s,n,t)})}function Ph(r,e,t,s){return It(this,void 0,void 0,function*(){return Rs(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Wo(r,e,t,s,n){return It(this,void 0,void 0,function*(){return Rs(r,"DELETE",e,s,n,t)})}var je=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Rh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ki={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ih{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=zo(n)}uploadOrUpdate(e,t,s,n){return je(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},ki),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const c=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?cn:Xe)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(ue(i))return{data:null,error:i};throw i}})}upload(e,t,s){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return je(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:ki.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield cn(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(ue(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return je(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield Xe(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new Bn("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}})}update(e,t,s){return je(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return je(this,void 0,void 0,function*(){try{return{data:yield Xe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}})}copy(e,t,s){return je(this,void 0,void 0,function*(){try{return{data:{path:(yield Xe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return je(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield Xe(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return je(this,void 0,void 0,function*(){try{const n=yield Xe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}})}download(e,t){return je(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Hs(this.fetch,`${this.url}/${n}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(ue(l))return{data:null,error:l};throw l}})}info(e){return je(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Hs(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ln(s),error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}})}exists(e){return je(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ph(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(ue(s)&&s instanceof on){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return je(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}})}list(e,t,s){return je(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Rh),t),{prefix:e||""});return{data:yield Xe(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(ue(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const $h="2.10.5",Mh={"X-Client-Info":`storage-js/${$h}`};var Mt=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class Lh{constructor(e,t={},s,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Mh),t),this.fetch=zo(s)}listBuckets(){return Mt(this,void 0,void 0,function*(){try{return{data:yield Hs(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ue(e))return{data:null,error:e};throw e}})}getBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Hs(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Mt(this,void 0,void 0,function*(){try{return{data:yield Xe(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Mt(this,void 0,void 0,function*(){try{return{data:yield cn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(ue(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Xe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Mt(this,void 0,void 0,function*(){try{return{data:yield Wo(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ue(t))return{data:null,error:t};throw t}})}}class Uh extends Lh{constructor(e,t={},s,n){super(e,t,s,n)}from(e){return new Ih(this.url,this.headers,e,this.fetch)}}const Fh="2.55.0";let ys="";typeof Deno<"u"?ys="deno":typeof document<"u"?ys="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ys="react-native":ys="node";const Bh={"X-Client-Info":`supabase-js-${ys}/${Fh}`},qh={headers:Bh},Kh={schema:"public"},zh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wh={};var Vh=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Hh=r=>{let e;return r?e=r:typeof fetch>"u"?e=Do:e=fetch,(...t)=>e(...t)},Gh=()=>typeof Headers>"u"?Oo:Headers,Qh=(r,e,t)=>{const s=Hh(t),n=Gh();return(i,a)=>Vh(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new n(a==null?void 0:a.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},a),{headers:d}))})};var Jh=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};function Yh(r){return r.endsWith("/")?r:r+"/"}function Xh(r,e){var t,s;const{db:n,auth:i,realtime:a,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>Jh(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const Vo="2.71.1",qt=30*1e3,dn=3,Cr=dn*qt,Zh="http://localhost:9999",ef="supabase.auth.token",tf={"X-Client-Info":`gotrue-js/${Vo}`},un="X-Supabase-Api-Version",Ho={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},sf=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,rf=10*60*1e3;class qn extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function z(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class nf extends qn{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function af(r){return z(r)&&r.name==="AuthApiError"}class Go extends qn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class mt extends qn{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class nt extends mt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function of(r){return z(r)&&r.name==="AuthSessionMissingError"}class Us extends mt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fs extends mt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Bs extends mt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function lf(r){return z(r)&&r.name==="AuthImplicitGrantRedirectError"}class Si extends mt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hn extends mt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Tr(r){return z(r)&&r.name==="AuthRetryableFetchError"}class ji extends mt{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class fn extends mt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ei=` 	
\r=`.split(""),cf=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Ei.length;e+=1)r[Ei[e].charCodeAt(0)]=-2;for(let e=0;e<Gs.length;e+=1)r[Gs[e].charCodeAt(0)]=e;return r})();function Ci(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Gs[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Gs[s]),e.queuedBits-=6}}function Qo(r,e,t){const s=cf[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Ti(r){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=a=>{hf(a,s,t)};for(let a=0;a<r.length;a+=1)Qo(r.charCodeAt(a),n,i);return e.join("")}function df(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function uf(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}df(s,e)}}function hf(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if(!(r>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ff(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)Qo(r.charCodeAt(n),t,s);return new Uint8Array(e)}function gf(r){const e=[];return uf(r,t=>e.push(t)),new Uint8Array(e)}function pf(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>Ci(n,t,s)),Ci(null,t,s),e.join("")}function mf(r){return Math.round(Date.now()/1e3)+r}function yf(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const $e=()=>typeof window<"u"&&typeof document<"u",bt={tested:!1,writable:!1},Jo=()=>{if(!$e())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(bt.tested)return bt.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),bt.tested=!0,bt.writable=!0}catch{bt.tested=!0,bt.writable=!1}return bt.writable};function vf(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Yo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>As(async()=>{const{default:s}=await Promise.resolve().then(()=>us);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},bf=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Kt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},wt=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},st=async(r,e)=>{await r.removeItem(e)};class yr{constructor(){this.promise=new yr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}yr.promiseConstructor=Promise;function Nr(r){const e=r.split(".");if(e.length!==3)throw new fn("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!sf.test(e[s]))throw new fn("JWT not in base64url format");return{header:JSON.parse(Ti(e[0])),payload:JSON.parse(Ti(e[1])),signature:ff(e[2]),raw:{header:e[0],payload:e[1]}}}async function wf(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function xf(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function _f(r){return("0"+r.toString(16)).substr(-2)}function kf(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,_f).join("")}async function Sf(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function jf(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Sf(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lt(r,e,t=!1){const s=kf();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await Kt(r,`${e}-code-verifier`,n);const i=await jf(s);return[i,s===i?"plain":"s256"]}const Ef=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Cf(r){const e=r.headers.get(un);if(!e||!e.match(Ef))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Tf(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Nf(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Df=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ut(r){if(!Df.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Dr(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ni(r){return JSON.parse(JSON.stringify(r))}var Of=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const xt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Af=[502,503,504];async function Di(r){var e;if(!bf(r))throw new hn(xt(r),0);if(Af.includes(r.status))throw new hn(xt(r),r.status);let t;try{t=await r.json()}catch(i){throw new Go(xt(i),i)}let s;const n=Cf(r);if(n&&n.getTime()>=Ho["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new ji(xt(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new nt}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new ji(xt(t),r.status,t.weak_password.reasons);throw new nf(xt(t),r.status||500,s)}const Pf=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function Q(r,e,t,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[un]||(i[un]=Ho["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",c=await Rf(r,e,t+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function Rf(r,e,t,s,n,i){const a=Pf(e,s,n,i);let l;try{l=await r(t,Object.assign({},a))}catch(c){throw console.error(c),new hn(xt(c),0)}if(l.ok||await Di(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Di(c)}}function Je(r){var e;let t=null;Lf(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=mf(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Oi(r){const e=Je(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function at(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function If(r){return{data:r,error:null}}function $f(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=Of(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},c=Object.assign({},a);return{data:{properties:l,user:c},error:null}}function Mf(r){return r}function Lf(r){return r.access_token&&r.refresh_token&&r.expires_in}const Or=["global","local","others"];var Uf=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Ff{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Yo(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Or[0]){if(Or.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Or.join(", ")}`);try{return await Q(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(z(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Q(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:at})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Uf(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await Q(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$f,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(z(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Q(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:at})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Q(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Mf});if(u.error)throw u.error;const h=await u.json(),f=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(b.split(";")[1].split("=")[1]);d[`${m}Page`]=v}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(z(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ut(e);try{return await Q(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:at})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ut(e);try{return await Q(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:at})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Ut(e);try{return await Q(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:at})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ut(e.userId);try{const{data:t,error:s}=await Q(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(z(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ut(e.userId),Ut(e.id);try{return{data:await Q(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}}}function Ai(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Bf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ft={debug:!!(globalThis&&Jo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Xo extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qf extends Xo{}async function Kf(r,e,t){Ft.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ft.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Ft.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{Ft.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw Ft.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new qf(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Ft.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Bf();const zf={url:Zh,storageKey:ef,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tf,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Pi(r,e,t){return await t()}const Bt={};class js{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=js.nextInstanceID,js.nextInstanceID+=1,this.instanceID>0&&$e()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},zf),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Ff({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Yo(n.fetch),this.lock=n.lock||Pi,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:$e()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Kf:this.lock=Pi,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Jo()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ai(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ai(this.memoryStorage)),$e()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Bt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Bt[this.storageKey]=Object.assign(Object.assign({},Bt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Bt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Bt[this.storageKey]=Object.assign(Object.assign({},Bt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Vo}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=vf(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),$e()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),lf(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return z(t)?{error:t}:{error:new Go("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Je}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,b=null;this.flowType==="pkce"&&([p,b]=await Lt(this.storage,this.storageKey)),i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:b},xform:Je})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Je})}else throw new Fs("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const c=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:l}=e;t=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Oi})}else if("phone"in e){const{phone:i,password:a,options:l}=e;t=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Oi})}else throw new Fs("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Us}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,i,a,l,c,d,u,h,f,p;let b,v;if("message"in e)b=e.message,v=e.signature;else{const{chain:m,wallet:x,statement:_,options:w}=e;let k;if($e())if(typeof x=="object")k=x;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))k=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=x}const A=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in k&&k.signIn){const C=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),_?{statement:_}:null));let O;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")O=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)O=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)b=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),v=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${A.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(n=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w==null?void 0:w.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const C=await k.signMessage(new TextEncoder().encode(b),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:m,error:x}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:pf(v)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Je});if(x)throw x;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new Us}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:x})}catch(m){if(z(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await wt(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:i,error:a}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Je});if(await st(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Us}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,l=await Q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Je}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Us}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Lt(this.storage,this.storageKey));const{error:h}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(a=c==null?void 0:c.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Fs("You must provide either an email or phone number.")}catch(l){if(z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:l}=await Q(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Je});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const c=a.session,d=a.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Lt(this.storage,this.storageKey)),await Q(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:If})}catch(i){if(z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new nt;const{error:n}=await Q(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await Q(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:l}=await Q(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new Fs("You must provide either an email or phone number and a type")}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await wt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Cr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await wt(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Dr()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:at}):await this._useSession(async t=>{var s,n,i;const{data:a,error:l}=t;if(l)throw l;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new nt}:await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:at})})}catch(t){if(z(t))return of(t)&&(await this._removeSession(),await st(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new nt;const a=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Lt(this.storage,this.storageKey));const{data:d,error:u}=await Q(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:a.access_token,xform:at});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nt;const t=Date.now()/1e3;let s=t,n=!0,i=null;const{payload:a}=Nr(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(z(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:l}=t;if(l)throw l;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new nt;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(z(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!$e())throw new Bs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Bs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Si("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Si("No code detected.");const{data:_,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!a||!d)throw new Bs("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const p=f-u;p*1e3<=qt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const b=f-h;u-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,f,u):u-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,f,u);const{data:v,error:m}=await this._getUser(i);if(m)throw m;const x={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:e.type},error:null}}catch(s){if(z(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await wt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(af(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await st(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=yf(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Lt(this.storage,this.storageKey,!0));try{return await Q(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,l,c,d,u;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Q(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return $e()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(z(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await Q(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await xf(async n=>(n>0&&await wf(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await Q(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Je})),(n,i)=>{const a=200*Math.pow(2,n);return i&&Tr(i)&&Date.now()+a-s<qt})}catch(s){if(this._debug(t,"error",s),z(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),$e()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await wt(this.storage,this.storageKey);if(n&&this.userStorage){let a=await wt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:n.user},await Kt(this.userStorage,this.storageKey+"-user",a)),n.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Dr()}else if(n&&!n.user&&!n.user){const a=await wt(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(n.user=a.user,await st(this.storage,this.storageKey+"-user"),await Kt(this.storage,this.storageKey,n)):n.user=Dr()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Cr;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${Cr}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Tr(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(n.access_token);!l&&(a!=null&&a.user)?(n.user=a.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new nt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new yr;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new nt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),z(i)){const a={session:null,error:i};return Tr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await Kt(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const i=Ni(n);await Kt(this.storage,this.storageKey,i)}else{const n=Ni(t);await Kt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await st(this.storage,this.storageKey),await st(this.storage,this.storageKey+"-code-verifier"),await st(this.storage,this.storageKey+"-user"),this.userStorage&&await st(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&$e()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),qt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/qt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${qt}ms, refresh threshold is ${dn} ticks`),n<=dn&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Xo)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$e()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Lt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await Q(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Q(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(z(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:l}=await Q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(t){if(z(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await Q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(z(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Nr(n.access_token);let l=null;a.aal&&(l=a.aal);let c=l;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=a.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+rf>n)return s;const{data:i,error:a}=await Q(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:p,error:b}=await this.getSession();if(b||!p.session)return{data:null,error:b};s=p.session.access_token}const{header:n,payload:i,signature:a,raw:{header:l,payload:c}}=Nr(s);t!=null&&t.allowExpired||Tf(i.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:n,signature:a},error:null}}const u=Nf(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,a,gf(`${l}.${c}`)))throw new fn("Invalid JWT signature");return{data:{claims:i,header:n,signature:a},error:null}}catch(s){if(z(s))return{data:null,error:s};throw s}}}js.nextInstanceID=0;const Wf=js;class Vf extends Wf{constructor(e){super(e)}}var Hf=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function l(u){try{d(s.next(u))}catch(h){a(h)}}function c(u){try{d(s.throw(u))}catch(h){a(h)}}function d(u){u.done?i(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class Gf{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=Yh(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Kh,realtime:Wh,auth:Object.assign(Object.assign({},zh),{storageKey:d}),global:qh},h=Xh(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=Qh(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new ch(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Uh(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Uu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Hf(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:i,flowType:a,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Vf({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Eh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Qf=(r,e,t)=>new Gf(r,e,t);function Jf(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Jf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Yf="https://rvvunwqizlzlqrhmmera.supabase.co",Xf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2dnVud3Fpemx6bHFyaG1tZXJhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNzg0NzQsImV4cCI6MjA3MDc1NDQ3NH0.ZzJxdSPJtRkcGTUMNHhig6G8nPVLdJsABr0VPq-wXLI",Ht=Qf(Yf,Xf);class Kn{constructor(){this.DAYS_TO_KEEP=60,this.client=Ht,this.checkAuthStatus()}async checkAuthStatus(){try{const{data:{user:e}}=await this.client.auth.getUser();e?console.log("Authenticated as:",e.email):console.log("No authentication - read-only mode")}catch(e){console.warn("Auth check failed:",e)}}isConfigured(){return!0}getBookingKey(e,t){return`${e}-${t}`}async getBooking(e,t){try{const{data:s,error:n}=await this.client.from("desk_bookings").select("*").eq("desk_id",e).eq("date",t).limit(1);return n?(console.error("Supabase error fetching booking:",n),null):!s||s.length===0?null:this.mapFromDatabase(s[0])}catch(s){return console.error("Error fetching booking:",s),null}}async getAllBookings(){try{const{data:e,error:t}=await this.client.from("desk_bookings").select("*");if(t)return console.error("Supabase error fetching bookings:",t),{};const s={};for(const n of e||[]){const i=this.mapFromDatabase(n),a=this.getBookingKey(i.deskId,i.date);s[a]=i}return s}catch(e){return console.error("Error fetching all bookings:",e),{}}}async saveBooking(e){try{const t=this.mapToDatabase(e),{error:s}=await this.client.from("desk_bookings").upsert(t,{onConflict:"id",ignoreDuplicates:!1});if(s)throw console.error("Supabase upsert error:",s),s}catch(t){throw console.error("Error saving booking:",t),new Error("Failed to save booking")}}async deleteBooking(e,t){try{const{error:s}=await this.client.from("desk_bookings").delete().eq("desk_id",e).eq("date",t);if(s)throw s}catch(s){throw console.error("Error deleting booking:",s),new Error("Failed to delete booking")}}async bulkUpdateBookings(e){try{const t=e.map(n=>this.mapToDatabase(n)),{error:s}=await this.client.from("desk_bookings").upsert(t,{onConflict:"id"});if(s)throw s}catch(t){throw console.error("Error bulk updating bookings:",t),new Error("Failed to bulk update bookings")}}async getBookingsForDateRange(e,t){try{const{data:s,error:n}=await this.client.from("desk_bookings").select("*").gte("date",e).lte("date",t).order("date");if(n)throw n;return(s||[]).map(i=>this.mapFromDatabase(i))}catch(s){throw console.error("Error fetching bookings for date range:",s),new Error("Failed to fetch bookings for date range")}}async getBookingsForDesk(e,t,s){try{let n=this.client.from("desk_bookings").select("*").eq("desk_id",e);t&&(n=n.gte("date",t)),s&&(n=n.lte("date",s)),n=n.order("date");const{data:i,error:a}=await n;if(a)throw a;return(i||[]).map(l=>this.mapFromDatabase(l))}catch(n){throw console.error("Error fetching bookings for desk:",n),new Error("Failed to fetch bookings for desk")}}async getDeskStats(e){try{const{data:t,error:s}=await this.client.from("desk_bookings").select("status").in("date",e);if(s)throw s;const i=8*e.length;let a=0,l=0;for(const d of t||[])switch(d.status){case"assigned":a++;break;case"booked":l++;break}return{available:i-a-l,assigned:a,booked:l}}catch(t){throw console.error("Error fetching desk stats:",t),new Error("Failed to fetch desk stats")}}async clearAllBookings(){try{const{error:e}=await this.client.from("desk_bookings").delete().neq("id","");if(e)throw e}catch(e){throw console.error("Error clearing all bookings:",e),new Error("Failed to clear all bookings")}}async saveWaitingListEntry(e){try{const t={id:e.id,name:e.name,preferred_dates:e.preferredDates,contact_info:e.contactInfo,notes:e.notes,created_at:e.createdAt},{error:s}=await this.client.from("waiting_list_entries").upsert(t,{onConflict:"id"});if(s)throw s}catch(t){throw console.error("Error saving waiting list entry:",t),new Error("Failed to save waiting list entry")}}async getWaitingListEntries(){try{const{data:e,error:t}=await this.client.from("waiting_list_entries").select("*").order("created_at");if(t)throw t;return(e||[]).map(s=>({id:s.id,name:s.name,preferredDates:s.preferred_dates,contactInfo:s.contact_info,notes:s.notes,createdAt:s.created_at}))}catch(e){throw console.error("Error fetching waiting list entries:",e),new Error("Failed to fetch waiting list entries")}}async deleteWaitingListEntry(e){try{const{error:t}=await this.client.from("waiting_list_entries").delete().eq("id",e);if(t)throw t}catch(t){throw console.error("Error deleting waiting list entry:",t),new Error("Failed to delete waiting list entry")}}async getAppSettings(){try{const{data:e,error:t}=await this.client.from("app_settings").select("*").eq("id","default").limit(1);return t?(console.error("Supabase error fetching app settings:",t),null):!e||e.length===0?null:{currency:e[0].currency,createdAt:e[0].created_at,updatedAt:e[0].updated_at}}catch(e){return console.error("Error fetching app settings:",e),null}}async saveAppSettings(e){try{const t={id:"default",currency:e.currency,created_at:e.createdAt,updated_at:e.updatedAt},{error:s}=await this.client.from("app_settings").upsert(t,{onConflict:"id"});if(s)throw s}catch(t){throw console.error("Error saving app settings:",t),new Error("Failed to save app settings")}}mapToDatabase(e){return{id:this.stringToNumericId(e.id),desk_id:e.deskId,date:e.date,start_date:e.startDate,end_date:e.endDate,status:e.status,person_name:e.personName,title:e.title,price:e.price,currency:e.currency,created_at:e.createdAt}}mapFromDatabase(e){return{id:String(e.id),deskId:e.desk_id,date:e.date,startDate:e.start_date||e.date,endDate:e.end_date||e.date,status:e.status,personName:e.person_name,title:e.title,price:e.price,currency:e.currency||"BGN",createdAt:e.created_at}}stringToNumericId(e){let t=0;for(let s=0;s<e.length;s++){const n=e.charCodeAt(s);t=(t<<5)-t+n,t=t&t}return Math.abs(t)}}class Ar{constructor(){this.errors=[],this.supabaseStore=new Kn}generateNumericId(e){var n,i;const t=e.split("-");let s=0;if(t.length>=5){const a=parseInt(t[2])||2025,l=parseInt(t[3])||1,c=parseInt(t[4])||1,d=parseInt((n=t[1])==null?void 0:n.replace("desk",""))||1,u=parseInt((i=t[0])==null?void 0:i.replace("room",""))||1;s=a*1e7+l*1e5+c*1e3+u*10+d}else{let a=0;for(let l=0;l<e.length;l++){const c=e.charCodeAt(l);a=(a<<5)-a+c,a=a&a}s=Math.abs(a)}return s%2147483647}convertBooking(e){const t=this.generateNumericId(e.id);return{...e,id:t.toString(),startDate:e.startDate||e.date,endDate:e.endDate||e.date,createdAt:e.createdAt||new Date().toISOString(),currency:e.currency||"BGN"}}exportFromLocalStorage(){let e=window.localStorage.getItem("coworking-bookings");e||(e=window.localStorage.getItem("deskBookings"));const t=e?JSON.parse(e):{},s=Object.values(t);console.log("Found bookings in localStorage:",s.length);const n=window.localStorage.getItem("coworking-waiting-list"),i=n?JSON.parse(n):[],a=window.localStorage.getItem("coworking-settings"),l=a?JSON.parse(a):null;return{bookings:s,waitingList:i,settings:l}}async migrate(e={}){const{clearLocalStorageAfter:t=!1,dryRun:s=!1}=e;try{if(!this.supabaseStore.isConfigured())throw new Error("Supabase is not configured. Please set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY");const{bookings:n,waitingList:i,settings:a}=this.exportFromLocalStorage();if(console.log(`Found ${n.length} bookings to migrate`),console.log(`Found ${i.length} waiting list entries to migrate`),s)return console.log("DRY RUN - No data will be migrated"),console.log("Sample converted bookings:",n.slice(0,3).map(h=>this.convertBooking(h))),{success:!0,bookingsMigrated:n.length,waitingListMigrated:i.length,errors:[]};let l=0,c=0;for(const h of n)try{const f=this.convertBooking(h);await this.supabaseStore.saveBooking(f),l++,l%10===0&&console.log(`Progress: ${l}/${n.length} bookings migrated`)}catch(f){c++;const p=`Failed to migrate booking ${h.id}: ${f}`;this.errors.push(p),console.error("Individual booking migration error:",f,h)}console.log(`Migration complete: ${l} bookings migrated successfully, ${c} failed`),c>0&&this.errors.push(`${c} bookings failed to migrate`);let d=0;const u=Array.isArray(i)?i:[];for(const h of u)try{const f={...h,id:this.generateNumericId(h.id).toString()};await this.supabaseStore.saveWaitingListEntry(f),d++}catch(f){this.errors.push(`Failed to migrate waiting list entry ${h.id}: ${f}`),console.error("Waiting list migration error:",f)}if(d>0&&console.log(`Successfully migrated ${d} waiting list entries`),a)try{await this.supabaseStore.saveAppSettings(a),console.log("Successfully migrated app settings")}catch(h){this.errors.push(`Failed to migrate app settings: ${h}`),console.error("Settings migration error:",h)}return t&&this.errors.length===0&&(window.localStorage.removeItem("coworking-bookings"),window.localStorage.removeItem("deskBookings"),window.localStorage.removeItem("coworking-waiting-list"),window.localStorage.removeItem("coworking-settings"),console.log("Cleared localStorage after successful migration")),{success:this.errors.length===0,bookingsMigrated:l,waitingListMigrated:d,errors:this.errors}}catch(n){const i=n instanceof Error?n.message:String(n);return this.errors.push(i),{success:!1,bookingsMigrated:0,waitingListMigrated:0,errors:this.errors}}}createBackup(){const t={...this.exportFromLocalStorage(),backupDate:new Date().toISOString(),version:"1.0"};return JSON.stringify(t,null,2)}async verifyMigration(){let e=window.localStorage.getItem("coworking-bookings");e||(e=window.localStorage.getItem("deskBookings"));const t=e?JSON.parse(e):{},s=Object.values(t),n=await this.supabaseStore.getAllBookings(),i=Object.values(n);return{localStorageCount:s.length,supabaseCount:i.length,matched:s.length===i.length}}}const Zf=sr("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Qs=g.forwardRef(({className:r,variant:e,...t},s)=>o.jsx("div",{ref:s,role:"alert",className:K(Zf({variant:e}),r),...t}));Qs.displayName="Alert";const gn=g.forwardRef(({className:r,...e},t)=>o.jsx("h5",{ref:t,className:K("mb-1 font-medium leading-none tracking-tight",r),...e}));gn.displayName="AlertTitle";const Js=g.forwardRef(({className:r,...e},t)=>o.jsx("div",{ref:t,className:K("text-sm [&_p]:leading-relaxed",r),...e}));Js.displayName="AlertDescription";var zn="Progress",Wn=100,[eg,Wg]=Xs(zn),[tg,sg]=eg(zn),Zo=g.forwardRef((r,e)=>{const{__scopeProgress:t,value:s=null,max:n,getValueLabel:i=rg,...a}=r;(n||n===0)&&!Ri(n)&&console.error(ng(`${n}`,"Progress"));const l=Ri(n)?n:Wn;s!==null&&!Ii(s,l)&&console.error(ig(`${s}`,"Progress"));const c=Ii(s,l)?s:null,d=Ys(c)?i(c,l):void 0;return o.jsx(tg,{scope:t,value:c,max:l,children:o.jsx(Pe.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Ys(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":sl(c,l),"data-value":c??void 0,"data-max":l,...a,ref:e})})});Zo.displayName=zn;var el="ProgressIndicator",tl=g.forwardRef((r,e)=>{const{__scopeProgress:t,...s}=r,n=sg(el,t);return o.jsx(Pe.div,{"data-state":sl(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...s,ref:e})});tl.displayName=el;function rg(r,e){return`${Math.round(r/e*100)}%`}function sl(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function Ys(r){return typeof r=="number"}function Ri(r){return Ys(r)&&!isNaN(r)&&r>0}function Ii(r,e){return Ys(r)&&!isNaN(r)&&r<=e&&r>=0}function ng(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Wn}\`.`}function ig(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Wn} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var rl=Zo,ag=tl;const nl=g.forwardRef(({className:r,value:e,...t},s)=>o.jsx(rl,{ref:s,className:K("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...t,children:o.jsx(ag,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));nl.displayName=rl.displayName;function og(){const[r,e]=g.useState("idle"),[t,s]=g.useState(null),[n,i]=g.useState(!1),[a,l]=g.useState(0),[c,d]=g.useState(null),u=()=>{try{const v=new Ar().createBackup(),m=new Blob([v],{type:"application/json"}),x=URL.createObjectURL(m),_=document.createElement("a");_.href=x,_.download=`deskplanner-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(x)}catch(b){console.error("Backup failed:",b),alert("Failed to create backup")}},h=async()=>{try{e("running"),l(50);const v=await new Ar().migrate({dryRun:!0});l(100),s(v),e(v.success?"success":"error")}catch(b){console.error("Dry run failed:",b),e("error"),s({success:!1,bookingsMigrated:0,waitingListMigrated:0,errors:[b instanceof Error?b.message:"Unknown error"]})}},f=async()=>{try{e("running"),l(0);const b=new Ar;l(30);const v=await b.migrate({clearLocalStorageAfter:n,dryRun:!1});l(70);const m=await b.verifyMigration();d(m),l(100),s(v),e(v.success?"success":"error"),v.success&&n&&setTimeout(()=>{window.location.reload()},3e3)}catch(b){console.error("Migration failed:",b),e("error"),s({success:!1,bookingsMigrated:0,waitingListMigrated:0,errors:[b instanceof Error?b.message:"Unknown error"]})}},p=!0;return o.jsxs(Le,{className:"w-full max-w-2xl mx-auto",children:[o.jsxs(or,{children:[o.jsxs(lr,{className:"flex items-center gap-2",children:[o.jsx(Qc,{className:"h-5 w-5"}),"Data Migration Tool"]}),o.jsx(An,{children:"Migrate your data from localStorage to Supabase database"})]}),o.jsxs(Ve,{className:"space-y-4",children:[!p,r==="running"&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ss,{className:"h-4 w-4 animate-spin"}),o.jsx("span",{className:"text-sm",children:"Migration in progress..."})]}),o.jsx(nl,{value:a})]}),t&&r!=="running"&&o.jsxs(Qs,{variant:t.success?"default":"destructive",children:[t.success?o.jsx(Vc,{className:"h-4 w-4"}):o.jsx(Nn,{className:"h-4 w-4"}),o.jsx(gn,{children:t.success?"Migration Successful":"Migration Failed"}),o.jsx(Js,{children:o.jsxs("div",{className:"space-y-1 mt-2",children:[o.jsxs("p",{children:["Bookings migrated: ",t.bookingsMigrated]}),o.jsxs("p",{children:["Waiting list entries migrated: ",t.waitingListMigrated]}),t.errors.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("p",{className:"font-semibold",children:"Errors:"}),o.jsx("ul",{className:"list-disc list-inside text-sm",children:t.errors.map((b,v)=>o.jsx("li",{children:b},v))})]})]})})]}),c&&o.jsxs(Qs,{variant:c.matched?"default":"destructive",children:[o.jsx(gn,{children:"Verification Result"}),o.jsxs(Js,{children:[o.jsxs("p",{children:["LocalStorage records: ",c.localStorageCount]}),o.jsxs("p",{children:["Supabase records: ",c.supabaseCount]}),o.jsxs("p",{children:["Status: ",c.matched?"✅ Counts match":"⚠️ Counts do not match"]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Mn,{id:"clear-storage",checked:n,onCheckedChange:b=>i(b),disabled:r==="running"}),o.jsx("label",{htmlFor:"clear-storage",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Clear localStorage after successful migration"})]}),o.jsxs("div",{className:"flex gap-2 flex-wrap",children:[o.jsxs(se,{onClick:u,variant:"outline",disabled:r==="running",children:[o.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Backup Data"]}),o.jsx(se,{onClick:h,variant:"outline",disabled:r==="running"||!p,children:"Dry Run"}),o.jsxs(se,{onClick:f,disabled:r==="running"||!p,children:[o.jsx(td,{className:"mr-2 h-4 w-4"}),"Start Migration"]})]}),o.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[o.jsx("p",{children:"• Create a backup before migrating your data"}),o.jsx("p",{children:'• Use "Dry Run" to preview what will be migrated'}),o.jsx("p",{children:"• The migration will convert string IDs to numeric IDs automatically"}),o.jsx("p",{children:"• Existing data in Supabase will be updated if IDs match"})]})]})]})}function lg({isOpen:r,onClose:e}){return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(Pt,{children:[o.jsx(Rt,{children:"Database Migration"}),o.jsx(po,{children:"Transfer your data from browser storage to Supabase cloud database"})]}),o.jsx(og,{})]})})}class il{constructor(){this.apiUrl="",this.apiKey="",this.database="deskplanner",this.dataSource="Cluster0",(!this.apiUrl||!this.apiKey)&&console.warn("MongoDB Data API credentials not configured. Using localStorage fallback.")}async request(e,t){if(!this.apiUrl||!this.apiKey)throw new Error("MongoDB Data API not configured");const s=await fetch(`${this.apiUrl}/action/${e}`,{method:"POST",headers:{"Content-Type":"application/json","api-key":this.apiKey},body:JSON.stringify({...t,database:this.database,dataSource:this.dataSource})});if(!s.ok){const n=await s.text();throw new Error(`MongoDB Data API error: ${n}`)}return s.json()}async findOne(e,t){return(await this.request("findOne",{collection:e,filter:t})).document}async find(e,t={},s={}){return(await this.request("find",{collection:e,filter:t,...s})).documents}async insertOne(e,t){return(await this.request("insertOne",{collection:e,document:t})).insertedId}async insertMany(e,t){return(await this.request("insertMany",{collection:e,documents:t})).insertedIds}async updateOne(e,t,s){return(await this.request("updateOne",{collection:e,filter:t,update:{$set:s}})).modifiedCount}async updateMany(e,t,s){return(await this.request("updateMany",{collection:e,filter:t,update:{$set:s}})).modifiedCount}async replaceOne(e,t,s){return(await this.request("replaceOne",{collection:e,filter:t,replacement:s})).modifiedCount}async deleteOne(e,t){return(await this.request("deleteOne",{collection:e,filter:t})).deletedCount}async deleteMany(e,t){return(await this.request("deleteMany",{collection:e,filter:t})).deletedCount}isConfigured(){return!!(this.apiUrl&&this.apiKey)}}class cg{constructor(){if(this.COLLECTION_NAME="bookings",this.DESKS_COLLECTION="desks",this.DESK_COUNT=8,this.client=new il,!this.client.isConfigured())throw new Error("MongoDB Data API is not configured. Please set up environment variables.")}getBookingKey(e,t){return`${e}-${t}`}async getBooking(e,t){try{return await this.client.findOne(this.COLLECTION_NAME,{deskId:e,date:t})}catch(s){return console.error("Error fetching booking from MongoDB:",s),null}}async getAllBookings(){try{const e=await this.client.find(this.COLLECTION_NAME,{}),t={};for(const s of e){const n=this.getBookingKey(s.deskId,s.date);t[n]=s}return t}catch(e){return console.error("Error fetching all bookings from MongoDB:",e),{}}}async saveBooking(e){try{const t={...e,_id:this.getBookingKey(e.deskId,e.date),startDate:e.startDate||e.date,endDate:e.endDate||e.date,createdAt:e.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()};await this.client.findOne(this.COLLECTION_NAME,{deskId:e.deskId,date:e.date})?await this.client.replaceOne(this.COLLECTION_NAME,{deskId:e.deskId,date:e.date},t):await this.client.insertOne(this.COLLECTION_NAME,t)}catch(t){throw console.error("Error saving booking to MongoDB:",t),new Error("Failed to save booking")}}async deleteBooking(e,t){try{await this.client.deleteOne(this.COLLECTION_NAME,{deskId:e,date:t})}catch(s){throw console.error("Error deleting booking from MongoDB:",s),new Error("Failed to delete booking")}}async bulkUpdateBookings(e){try{for(let s=0;s<e.length;s+=20){const i=e.slice(s,s+20).map(a=>this.saveBooking(a));await Promise.all(i)}}catch(t){throw console.error("Error bulk updating bookings in MongoDB:",t),new Error("Failed to bulk update bookings")}}async getBookingsForDateRange(e,t){try{return await this.client.find(this.COLLECTION_NAME,{date:{$gte:e,$lte:t}},{sort:{date:1,deskId:1}})}catch(s){return console.error("Error fetching bookings for date range from MongoDB:",s),[]}}async getBookingsForDesk(e,t,s){try{const n={deskId:e};return t&&s&&(n.date={$gte:t,$lte:s}),await this.client.find(this.COLLECTION_NAME,n,{sort:{date:1}})}catch(n){return console.error("Error fetching bookings for desk from MongoDB:",n),[]}}async getDeskStats(e){try{const t=this.DESK_COUNT*e.length,s=await this.client.find(this.COLLECTION_NAME,{date:{$in:e}});let n=0,i=0;for(const l of s)switch(l.status){case"assigned":n++;break;case"booked":i++;break}return{available:t-n-i,assigned:n,booked:i}}catch(t){return console.error("Error fetching desk stats from MongoDB:",t),{available:this.DESK_COUNT*e.length,assigned:0,booked:0}}}async clearAllBookings(){try{await this.client.deleteMany(this.COLLECTION_NAME,{})}catch(e){throw console.error("Error clearing all bookings from MongoDB:",e),new Error("Failed to clear all bookings")}}async initializeDesks(){try{const e=[{_id:"room1-desk1",room:1,number:1,label:"Room 1, Desk 1"},{_id:"room1-desk2",room:1,number:2,label:"Room 1, Desk 2"},{_id:"room1-desk3",room:1,number:3,label:"Room 1, Desk 3"},{_id:"room1-desk4",room:1,number:4,label:"Room 1, Desk 4"},{_id:"room2-desk1",room:2,number:1,label:"Room 2, Desk 1"},{_id:"room2-desk2",room:2,number:2,label:"Room 2, Desk 2"},{_id:"room2-desk3",room:2,number:3,label:"Room 2, Desk 3"},{_id:"room2-desk4",room:2,number:4,label:"Room 2, Desk 4"}];(await this.client.find(this.DESKS_COLLECTION,{})).length===0&&(await this.client.insertMany(this.DESKS_COLLECTION,e),console.log("Initialized desks collection in MongoDB"))}catch(e){console.error("Error initializing desks:",e)}}}const Pr="deskplanner_sync_metadata";class al{constructor(){this.deviceId=this.getOrCreateDeviceId()}getOrCreateDeviceId(){let e=localStorage.getItem("deskplanner_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("deskplanner_device_id",e)),e}getLocalMetadata(){try{const e=localStorage.getItem(Pr);return e?JSON.parse(e):null}catch(e){return console.error("Error reading sync metadata:",e),null}}updateLocalMetadata(e){const s={...this.getLocalMetadata()||{deviceId:this.deviceId,lastLocalUpdate:new Date().toISOString(),lastCloudUpdate:new Date(0).toISOString(),dataVersion:1},...e,deviceId:this.deviceId};localStorage.setItem(Pr,JSON.stringify(s))}markLocalUpdate(){const e=this.getLocalMetadata();this.updateLocalMetadata({lastLocalUpdate:new Date().toISOString(),dataVersion:((e==null?void 0:e.dataVersion)||0)+1})}markCloudSync(){const e=new Date().toISOString();this.updateLocalMetadata({lastCloudUpdate:e,lastLocalUpdate:e})}getSyncDirection(e){const t=this.getLocalMetadata();if(!t)return e?"pull":"none";if(!e)return"push";const s=new Date(t.lastLocalUpdate).getTime(),n=new Date(e.lastUpdate).getTime();return Math.abs(s-n)<1e3?"none":s>n?"push":"pull"}isNewDevice(){if(!this.getLocalMetadata())return!0;const t=localStorage.getItem("coworking-bookings")||localStorage.getItem("deskBookings");if(!t)return!0;try{const s=JSON.parse(t);return Object.keys(s).length===0}catch{return!0}}reset(){localStorage.removeItem(Pr)}}class pn{constructor(){this.syncQueue=new Set,this.syncRetryTimeout=null,this.syncStatusCallbacks=[],this.localStorage=new zt,this.metadataManager=new al;try{const e=new Kn;e.isConfigured()?(this.supabase=e,console.log("Hybrid storage: Supabase configured for sync")):(this.supabase=null,console.log("Hybrid storage: Running in offline mode (localStorage only)"))}catch(e){this.supabase=null,console.warn("Hybrid storage: Supabase initialization failed, using offline mode",e)}this.syncStatus={lastSyncTime:null,syncInProgress:!1,lastSyncError:null,pendingChanges:0,isOnline:this.supabase!==null},this.supabase&&(this.initializeData(),this.startPeriodicSync())}onSyncStatusChange(e){return this.syncStatusCallbacks.push(e),()=>{const t=this.syncStatusCallbacks.indexOf(e);t>-1&&this.syncStatusCallbacks.splice(t,1)}}updateSyncStatus(e){this.syncStatus={...this.syncStatus,...e},this.syncStatusCallbacks.forEach(t=>t(this.syncStatus))}async initializeData(){if(this.supabase)try{if(this.metadataManager.isNewDevice()){console.log("New device detected, pulling data from cloud..."),await this.pullFromCloud();return}const e=await this.getCloudMetadata(),t=this.metadataManager.getSyncDirection(e||void 0);console.log("Sync direction on init:",t),t==="pull"?await this.promptUserForConflictResolution()&&await this.pullFromCloud():t==="push"&&(console.log("Local data is newer, will sync to cloud..."),await this.forceFullSync())}catch(e){console.error("Error initializing data:",e),this.updateSyncStatus({lastSyncError:"Failed to initialize data"})}}async getCloudMetadata(){if(!this.supabase)return null;try{const e=await this.supabase.client.from("sync_metadata").select("last_update, data_version, bookings_count").eq("id","global").single();return e.data?{lastUpdate:e.data.last_update}:null}catch(e){return console.error("Error fetching cloud metadata:",e),null}}async pullFromCloud(){if(this.supabase){this.updateSyncStatus({syncInProgress:!0});try{const e=await this.supabase.getAllBookings();await this.localStorage.clearAllBookings();for(const t of Object.values(e))await this.localStorage.saveBooking(t);this.metadataManager.markCloudSync(),this.updateSyncStatus({syncInProgress:!1,lastSyncTime:new Date,lastSyncError:null,pendingChanges:0}),console.log(`Pulled ${Object.keys(e).length} bookings from cloud`)}catch(e){console.error("Error pulling from cloud:",e),this.updateSyncStatus({syncInProgress:!1,lastSyncError:"Failed to pull data from cloud"})}}}async promptUserForConflictResolution(){return console.warn("Data conflict detected: Cloud data is newer than local data"),!1}startPeriodicSync(){setInterval(()=>{this.syncQueue.size>0&&!this.syncStatus.syncInProgress&&this.performBackgroundSync()},3e4)}async performBackgroundSync(){if(!(!this.supabase||this.syncStatus.syncInProgress)){this.updateSyncStatus({syncInProgress:!0});try{const e=Array.from(this.syncQueue),t=await this.localStorage.getAllBookings();for(const s of e){const n=t[s];if(n)try{await this.supabase.saveBooking(n),this.syncQueue.delete(s)}catch(i){console.error(`Failed to sync booking ${s}:`,i)}else{const[i,a]=s.split("-").reduce((l,c,d)=>(d<2?l[0]=l[0]?`${l[0]}-${c}`:c:l[1]=l[1]?`${l[1]}-${c}`:c,l),["",""]);if(i&&a)try{await this.supabase.deleteBooking(i,a),this.syncQueue.delete(s)}catch(l){console.error(`Failed to sync deletion ${s}:`,l)}}}this.syncQueue.size===0&&this.metadataManager.markCloudSync(),this.updateSyncStatus({syncInProgress:!1,lastSyncTime:new Date,lastSyncError:null,pendingChanges:this.syncQueue.size})}catch(e){this.updateSyncStatus({syncInProgress:!1,lastSyncError:e instanceof Error?e.message:"Unknown sync error",pendingChanges:this.syncQueue.size}),this.syncRetryTimeout&&clearTimeout(this.syncRetryTimeout),this.syncRetryTimeout=setTimeout(()=>{this.performBackgroundSync()},5e3)}}}addToSyncQueue(e){this.syncQueue.add(e),this.updateSyncStatus({pendingChanges:this.syncQueue.size}),!this.syncStatus.syncInProgress&&this.supabase&&setTimeout(()=>this.performBackgroundSync(),100)}getBookingKey(e,t){return`${e}-${t}`}async getBooking(e,t){return this.localStorage.getBooking(e,t)}async getAllBookings(){return this.localStorage.getAllBookings()}async saveBooking(e){await this.localStorage.saveBooking(e),this.metadataManager.markLocalUpdate();const t=this.getBookingKey(e.deskId,e.date);this.addToSyncQueue(t)}async deleteBooking(e,t){await this.localStorage.deleteBooking(e,t),this.metadataManager.markLocalUpdate();const s=this.getBookingKey(e,t);this.addToSyncQueue(s)}async bulkUpdateBookings(e){await this.localStorage.bulkUpdateBookings(e),this.metadataManager.markLocalUpdate(),e.forEach(t=>{const s=this.getBookingKey(t.deskId,t.date);this.addToSyncQueue(s)})}async getBookingsForDateRange(e,t){return this.localStorage.getBookingsForDateRange(e,t)}async getBookingsForDesk(e,t,s){return this.localStorage.getBookingsForDesk(e,t,s)}async getDeskStats(e){return this.localStorage.getDeskStats(e)}async clearAllBookings(){await this.localStorage.clearAllBookings(),this.supabase&&this.supabase.clearAllBookings().catch(e=>{console.error("Failed to clear Supabase bookings:",e)}),this.syncQueue.clear(),this.updateSyncStatus({pendingChanges:0})}async forceFullSync(){if(!this.supabase)return{success:!1,error:"Supabase not configured"};try{this.updateSyncStatus({syncInProgress:!0});const e=await this.localStorage.getAllBookings(),t=Object.values(e);await this.supabase.clearAllBookings();for(const s of t)await this.supabase.saveBooking(s);return this.syncQueue.clear(),this.updateSyncStatus({syncInProgress:!1,lastSyncTime:new Date,lastSyncError:null,pendingChanges:0}),{success:!0}}catch(e){const t=e instanceof Error?e.message:"Unknown error";return this.updateSyncStatus({syncInProgress:!1,lastSyncError:t}),{success:!1,error:t}}}getSyncStatus(){return{...this.syncStatus}}}class zt{constructor(){this.STORAGE_KEY="deskBookings",this.DAYS_TO_KEEP=60,this.cleanupOldBookings()}getBookingKey(e,t){return`${e}-${t}`}cleanupOldBookings(){try{const e=this.getStorageData(),t=new Date;t.setHours(0,0,0,0);const s=new Date(t);s.setDate(s.getDate()-this.DAYS_TO_KEEP);let n=0;const i={};for(const[a,l]of Object.entries(e))new Date(l.date+"T00:00:00")>=s?i[a]=l:n++;n>0&&(this.saveStorageData(i),console.log(`Automatically cleaned up ${n} bookings older than ${this.DAYS_TO_KEEP} days`))}catch(e){console.error("Error during cleanup:",e)}}getStorageData(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return{};const t=JSON.parse(e),s={};for(const[n,i]of Object.entries(t)){const a=i;a.status!=="unavailable"&&(s[n]=a)}return s}catch(e){return console.error("Error reading from localStorage:",e),{}}}saveStorageData(e){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){throw console.error("Error saving to localStorage:",t),new Error("Failed to save booking data")}}async getBooking(e,t){const s=this.getStorageData(),n=this.getBookingKey(e,t);return s[n]||null}async getAllBookings(){return this.getStorageData()}async saveBooking(e){const t=this.getStorageData(),s=this.getBookingKey(e.deskId,e.date),n={...e,startDate:e.startDate||e.date,endDate:e.endDate||e.date};t[s]=n,this.saveStorageData(t)}async deleteBooking(e,t){const s=this.getStorageData(),n=this.getBookingKey(e,t);delete s[n],this.saveStorageData(s)}async bulkUpdateBookings(e){const t=this.getStorageData();for(const s of e){const n=this.getBookingKey(s.deskId,s.date);t[n]=s}this.saveStorageData(t)}async getBookingsForDateRange(e,t){const s=this.getStorageData(),n=new Date(e),i=new Date(t);return Object.values(s).filter(a=>{const l=new Date(a.date);return l>=n&&l<=i})}async getBookingsForDesk(e,t,s){const n=this.getStorageData();let i=Object.values(n).filter(a=>a.deskId===e);if(t&&s){const a=new Date(t),l=new Date(s);i=i.filter(c=>{const d=new Date(c.date);return d>=a&&d<=l})}return i}async getDeskStats(e){const t=this.getStorageData(),n=8*e.length;let i=0,a=0;for(const c of Object.values(t))if(e.includes(c.date))switch(c.status){case"assigned":i++;break;case"booked":a++;break}return{available:n-i-a,assigned:i,booked:a}}async clearAllBookings(){localStorage.removeItem(this.STORAGE_KEY)}}function dg(r){const e="supabase";switch(console.log("DataStore factory - Storage type:",e),console.log("VITE_STORAGE_TYPE from env:","supabase"),e){case"localStorage":return console.log("Using LocalStorage for data persistence"),new zt;case"mongodb":return new il().isConfigured()?(console.log("Using MongoDB Data API for data persistence"),new cg):(console.warn("MongoDB not configured, falling back to localStorage"),new zt);case"supabase":try{console.log("Attempting to initialize Supabase..."),console.log("VITE_SUPABASE_URL:","https://rvvunwqizlzlqrhmmera.supabase.co"),console.log("VITE_SUPABASE_ANON_KEY present:",!0);const s=new Kn;return s.isConfigured()?(console.log("Using Supabase for data persistence"),s):(console.warn("Supabase not configured, falling back to localStorage"),new zt)}catch(s){return console.error("Error initializing Supabase, falling back to localStorage:",s),new zt}case"hybrid":return console.log("Using Hybrid storage (localStorage + Supabase sync)"),new pn;default:return console.warn(`Unknown data store type: ${e}, using localStorage`),new zt}}const me=dg(),$i=[{id:"room1-desk1",room:1,number:1,label:"Room 1 - Desk 1"},{id:"room1-desk2",room:1,number:2,label:"Room 1 - Desk 2"},{id:"room1-desk3",room:1,number:3,label:"Room 1 - Desk 3"},{id:"room1-desk4",room:1,number:4,label:"Room 1 - Desk 4"},{id:"room2-desk1",room:2,number:1,label:"Room 2 - Desk 1"},{id:"room2-desk2",room:2,number:2,label:"Room 2 - Desk 2"},{id:"room2-desk3",room:2,number:3,label:"Room 2 - Desk 3"},{id:"room2-desk4",room:2,number:4,label:"Room 2 - Desk 4"}],Mi=r=>{const t=new Date(r+"T00:00:00").getDay();return t===0||t===6};async function ug(){const r=new Date;r.setHours(0,0,0,0);const e=await me.getAllBookings(),t=new Map;Object.values(e).forEach(h=>{const f=`${h.deskId}-${h.date}`;t.set(f,h)});const s=[],n=new Map;let i=new Date(r);i.setDate(i.getDate()+1);const a=90;let l=0;for(;(s.length<5||n.size<3)&&l<a;){const h=i.toISOString().split("T")[0];if(!Mi(h)){let f=!1;const p=new Set;for(const b of $i){const v=`${b.id}-${h}`,m=t.get(v);m?m.status==="available"?f=!0:m.status==="booked"&&m.personName&&p.add(m.personName):f=!0}f&&s.length<5&&s.push(h),p.size>0&&n.size<3&&n.set(h,p)}i.setDate(i.getDate()+1),l++}const c=Array.from(n.entries()).map(([h,f])=>({date:h,names:Array.from(f)})),d=[],u=[];for(let h=1;h<=10;h++){const f=new Date(r);f.setDate(f.getDate()+h),u.push(f.toISOString().split("T")[0])}for(const h of u)if(!Mi(h))for(const f of $i){const p=`${f.id}-${h}`,b=t.get(p);b&&b.status==="assigned"&&b.personName&&b.endDate===h&&d.push({date:h,personName:b.personName,deskNumber:f.number})}return{available:s,booked:c,expiring:d}}function hg(){return kn({queryKey:["next-dates"],queryFn:ug,staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1})}function fg(){const r=_n();g.useEffect(()=>{console.log("Setting up real-time subscription for desk_bookings");const e=Ht.channel("desk_bookings_changes").on("postgres_changes",{event:"*",schema:"public",table:"desk_bookings"},t=>{console.log("Real-time update received:",t),r.invalidateQueries({queryKey:["desk-bookings"]}),r.invalidateQueries({queryKey:["desk-stats"]}),r.invalidateQueries({queryKey:["next-dates"]})}).subscribe(t=>{console.log("Real-time subscription status:",t)});return()=>{console.log("Cleaning up real-time subscription"),e.unsubscribe()}},[r])}function gg(){return kn({queryKey:["desk-bookings"],queryFn:async()=>{const[r,e]=await Promise.all([me.getAllBookings(),Promise.resolve([])]);return r},staleTime:2*60*1e3,gcTime:5*60*1e3,refetchOnWindowFocus:!1,retry:1})}function pg(r){return kn({queryKey:["desk-stats",r],queryFn:()=>me.getDeskStats(r),staleTime:2*60*1e3,gcTime:5*60*1e3,refetchOnWindowFocus:!1,retry:1,enabled:r.length>0})}function mg({onCurrencyChange:r}){const[e,t]=g.useState("BGN");g.useEffect(()=>{t(fo())},[]);const s=n=>{t(n),ou(n),r==null||r(n)};return o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Currency:"}),o.jsxs(Rn,{value:e,onValueChange:s,children:[o.jsx(cr,{className:"w-32",children:o.jsx(In,{})}),o.jsxs(dr,{children:[o.jsx(gt,{value:"USD",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:Dt.USD}),o.jsx("span",{children:"USD"})]})}),o.jsx(gt,{value:"EUR",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:Dt.EUR}),o.jsx("span",{children:"EUR"})]})}),o.jsx(gt,{value:"BGN",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:Dt.BGN}),o.jsx("span",{children:"BGN"})]})})]})]})]})}const Li="coworking-waiting-list";class yg{getStorageData(){try{const e=localStorage.getItem(Li);return e?JSON.parse(e):{}}catch(e){return console.error("Error loading waiting list from localStorage:",e),{}}}saveStorageData(e){try{localStorage.setItem(Li,JSON.stringify(e))}catch(t){throw console.error("Error saving waiting list to localStorage:",t),new Error("Failed to save waiting list data")}}async getAllEntries(){const e=this.getStorageData();return Object.values(e).sort((t,s)=>new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime())}async addEntry(e){const t=this.getStorageData(),s=`waiting-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n={...e,id:s,createdAt:new Date().toISOString()};return t[s]=n,this.saveStorageData(t),n}async removeEntry(e){const t=this.getStorageData();delete t[e],this.saveStorageData(t)}async updateEntry(e,t){const s=this.getStorageData();return s[e]?(s[e]={...s[e],...t},this.saveStorageData(s),s[e]):null}async clearAll(){this.saveStorageData({})}}const Rr=new yg;function vg({isOpen:r,onClose:e,onSave:t}){const[s,n]=g.useState(""),[i,a]=g.useState(""),[l,c]=g.useState(""),[d,u]=g.useState(""),h=()=>{const p=s.trim(),b=i.trim();p&&b&&(t({name:p,preferredDates:b,contactInfo:l.trim()||void 0,notes:d.trim()||void 0}),n(""),a(""),c(""),u(""),e())},f=p=>{p.key==="Enter"&&(p.ctrlKey||p.metaKey)&&h()};return o.jsx(ds,{open:r,onOpenChange:e,children:o.jsxs(At,{className:"max-w-md",children:[o.jsx(Pt,{children:o.jsxs(Rt,{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-blue-600",children:"person_add"}),"Add to Waiting List"]})}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Name *"}),o.jsx(Ne,{id:"name",value:s,onChange:p=>n(p.target.value),onKeyDown:f,placeholder:"Enter person's name",className:"mt-1",maxLength:50})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"dates",className:"text-sm font-medium text-gray-700",children:"Preferred Dates *"}),o.jsx(Ne,{id:"dates",value:i,onChange:p=>a(p.target.value),onKeyDown:f,placeholder:"e.g., Jan 15-20, Weekdays only, etc.",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter preferred dates or date ranges"})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"contact",className:"text-sm font-medium text-gray-700",children:"Contact Info"}),o.jsx(Ne,{id:"contact",value:l,onChange:p=>c(p.target.value),onKeyDown:f,placeholder:"Phone or email (optional)",className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(fe,{htmlFor:"notes",className:"text-sm font-medium text-gray-700",children:"Notes"}),o.jsx(Pn,{id:"notes",value:d,onChange:p=>u(p.target.value),placeholder:"Additional notes (optional)",className:"mt-1",rows:3})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(se,{variant:"outline",onClick:e,children:"Cancel"}),o.jsxs(se,{onClick:h,disabled:!s.trim()||!i.trim(),className:"bg-blue-600 hover:bg-blue-700",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"add"}),"Add to List"]})]})]})})}function bg(){const[r,e]=g.useState([]),[t,s]=g.useState(!1),{toast:n}=Sn();g.useEffect(()=>{i()},[]);const i=async()=>{try{const d=await Rr.getAllEntries();e(d)}catch(d){console.error("Error loading waiting list:",d),n({title:"Error",description:"Failed to load waiting list",variant:"destructive"})}},a=async d=>{try{await Rr.addEntry(d),await i(),n({title:"Added to Waiting List",description:`${d.name} has been added to the waiting list`})}catch{n({title:"Error",description:"Failed to add entry to waiting list",variant:"destructive"})}},l=async(d,u)=>{try{await Rr.removeEntry(d),await i(),n({title:"Removed from Waiting List",description:`${u} has been removed from the waiting list`})}catch{n({title:"Error",description:"Failed to remove entry",variant:"destructive"})}},c=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return o.jsxs(Le,{children:[o.jsx(or,{children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs(lr,{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-orange-600",children:"schedule"}),"Waiting List"]}),o.jsxs(se,{onClick:()=>s(!0),size:"sm",className:"bg-orange-600 hover:bg-orange-700",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"person_add"}),"Add Person"]})]})}),o.jsx(Ve,{children:r.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx("span",{className:"material-icon text-4xl mb-2 block text-gray-300",children:"people_outline"}),o.jsx("p",{children:"No one on the waiting list yet"}),o.jsx("p",{className:"text-sm",children:"Add people who are interested in booking desks"})]}):o.jsx("div",{className:"space-y-3",children:r.map(d=>o.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"material-icon text-orange-600 text-sm",children:"person"}),o.jsx("h4",{className:"font-medium text-gray-900",children:d.name})]}),o.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-xs",children:"date_range"}),o.jsx("span",{children:d.preferredDates})]}),d.contactInfo&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"material-icon text-xs",children:"contact_mail"}),o.jsx("span",{children:d.contactInfo})]}),d.notes&&o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"material-icon text-xs",children:"note"}),o.jsx("span",{children:d.notes})]}),o.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mt-2",children:[o.jsx("span",{className:"material-icon text-xs",children:"access_time"}),o.jsxs("span",{children:["Added ",c(d.createdAt)]})]})]})]}),o.jsx(se,{variant:"ghost",size:"sm",onClick:()=>l(d.id,d.name),className:"text-red-600 hover:text-red-800 hover:bg-red-50",children:o.jsx("span",{className:"material-icon text-sm",children:"delete"})})]})},d.id))})}),o.jsx(vg,{isOpen:t,onClose:()=>s(!1),onSave:a})]})}function wg(){const[r,e]=g.useState(null),[t,s]=g.useState(!1);if(g.useEffect(()=>{if(me instanceof pn)return s(!0),e(me.getSyncStatus()),me.onSyncStatusChange(u=>{e(u)})},[]),!t||!r)return null;const n=async()=>{me instanceof pn&&await me.forceFullSync()},i=()=>r.syncInProgress?o.jsx(ci,{className:"h-4 w-4 animate-spin"}):r.isOnline?r.lastSyncError?o.jsx(Nn,{className:"h-4 w-4"}):r.pendingChanges>0?o.jsx(Gc,{className:"h-4 w-4"}):o.jsx(Tn,{className:"h-4 w-4"}):o.jsx(Hc,{className:"h-4 w-4"}),a=()=>r.isOnline?r.lastSyncError?"text-red-500":r.pendingChanges>0?"text-yellow-500":"text-green-500":"text-gray-500",l=()=>r.isOnline?r.syncInProgress?"Syncing...":r.lastSyncError?"Sync Error":r.pendingChanges>0?`${r.pendingChanges} pending`:"Synced":"Offline Mode",c=()=>{const d=[];if(!r.isOnline)d.push("Running in offline mode (localStorage only)");else{if(r.lastSyncTime){const u=Date.now()-r.lastSyncTime.getTime(),h=Math.floor(u/6e4),f=Math.floor(u%6e4/1e3);h>0?d.push(`Last sync: ${h}m ${f}s ago`):d.push(`Last sync: ${f}s ago`)}else d.push("Not synced yet");r.pendingChanges>0&&d.push(`${r.pendingChanges} changes waiting to sync`),r.lastSyncError&&d.push(`Error: ${r.lastSyncError}`)}return d.join(`
`)};return o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(hi,{children:[o.jsx(fi,{asChild:!0,children:o.jsxs("div",{className:K("flex items-center gap-1.5 px-2 py-1 rounded-md text-sm cursor-help","bg-white/50 backdrop-blur-sm border",r.lastSyncError?"border-red-200":"border-gray-200"),children:[o.jsx("span",{className:a(),children:i()}),o.jsx("span",{className:"text-gray-700 text-xs font-medium",children:l()})]})}),o.jsx(tn,{className:"whitespace-pre-line",children:o.jsx("p",{children:c()})})]}),r.isOnline&&(r.lastSyncError||r.pendingChanges>5)&&o.jsxs(hi,{children:[o.jsx(fi,{asChild:!0,children:o.jsx(se,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:n,disabled:r.syncInProgress,children:o.jsx(ci,{className:K("h-3.5 w-3.5",r.syncInProgress&&"animate-spin")})})}),o.jsx(tn,{children:o.jsx("p",{children:"Force sync all data"})})]})]})}const ol=g.createContext(void 0),ll=()=>{const r=g.useContext(ol);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r};function xg({children:r}){const[e,t]=g.useState(null),[s,n]=g.useState(!0);g.useEffect(()=>{(async()=>{try{const{data:{session:c}}=await Ht.auth.getSession();t((c==null?void 0:c.user)??null)}catch(c){console.error("Error checking session:",c),t(null)}finally{n(!1)}})();const{data:{subscription:l}}=Ht.auth.onAuthStateChange((c,d)=>{t((d==null?void 0:d.user)??null),n(!1)});return()=>l.unsubscribe()},[]);const i=async()=>{try{await Ht.auth.signOut(),t(null),window.location.reload()}catch(a){console.error("Error signing out:",a)}};return o.jsx(ol.Provider,{value:{user:e,loading:s,signOut:i},children:r})}function Ui(){const{user:r,signOut:e}=ll(),[t,s]=g.useState("month"),[n,i]=g.useState(0),[a,l]=g.useState(0),[c,d]=g.useState(null),[u,h]=g.useState("BGN"),[f,p]=g.useState(!1),[b,v]=g.useState(!1),[m,x]=g.useState(!1),[_,w]=g.useState(!1),[k,A]=g.useState(!1),{toast:C}=Sn(),O=_n(),V=g.useRef(null),q=g.useMemo(()=>No(n),[n]),G=g.useMemo(()=>Tu(a),[a]),T=g.useMemo(()=>Nu(n),[n]),$=g.useMemo(()=>Du(a),[a]),le=g.useMemo(()=>t==="week"?q:G,[t,q,G]),S=g.useMemo(()=>le.map(D=>D.dateString),[le]),{data:E={},isLoading:j}=gg(),{data:P={available:0,assigned:0,booked:0},isLoading:N}=pg(S),{data:I,isLoading:L,error:H}=hg();fg();const Z=(I==null?void 0:I.available)||[],ee=(I==null?void 0:I.booked)||[],ie=(I==null?void 0:I.expiring)||[],ve=D=>{const U=new Date(D+"T00:00:00").getDay();return U===0||U===6};g.useEffect(()=>{h(fo())},[]),g.useEffect(()=>{if(t==="month"&&a===0&&V.current){const D=le.findIndex(F=>Re(F.dateString));D>=0&&setTimeout(()=>{if(V.current){const U=Math.max(0,D*120-32);V.current.scrollLeft=U}},100)}},[t,a,le]);const Ze=(D,F)=>{const U=`${D}-${F}`;return E[U]||null},Re=D=>{const U=new Date().toISOString().split("T")[0];return D===U},yt=g.useCallback(async(D,F,U)=>{if(ve(F))return;const M=await me.getBooking(D,F);if(U!=null&&U.ctrlKey||(U==null?void 0:U.button)===2){U==null||U.preventDefault();const ae=(M==null?void 0:M.status)||"available",ne=["available","booked"],de=(ne.indexOf(ae)+1)%ne.length,we=ne[de];if(we==="available")await me.deleteBooking(D,F);else{const De={id:`${D}-${F}`,deskId:D,date:F,startDate:F,endDate:F,status:we,personName:M==null?void 0:M.personName,title:M==null?void 0:M.title,price:M==null?void 0:M.price,currency:(M==null?void 0:M.currency)||u||"BGN",createdAt:(M==null?void 0:M.createdAt)||new Date().toISOString()};await me.saveBooking(De)}O.invalidateQueries({queryKey:["desk-bookings"]}),O.invalidateQueries({queryKey:["desk-stats"]}),O.invalidateQueries({queryKey:["next-dates"]}),C({title:"Desk Status Updated",description:`Desk status set to ${we}`});return}(M==null?void 0:M.status)==="booked"||(M==null?void 0:M.status)==="assigned"?(d({booking:M,deskId:D,date:F}),v(!0)):((M==null?void 0:M.status)==="available"||!M)&&(d({booking:null,deskId:D,date:F}),v(!0))},[S,C,u]),He=g.useCallback(async D=>{if(!c)return;const{deskId:F}=c,U=pi(D.startDate,D.endDate);if(!c.booking){const de=[],we=[];for(const De of U){const $t=await me.getBooking(F,De);if($t&&$t.status!=="available"){de.push(De);const Vn=new Date(De+"T00:00:00").toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});$t.personName?we.push(`${Vn}: ${$t.personName} (${$t.status})`):we.push(`${Vn}: Desk is ${$t.status}`)}}if(de.length>0){const De=`Cannot create booking due to conflicts on the following dates:

${we.join(`
`)}

Please choose different dates or select available time slots.`;throw new Error(De)}}const M=[];for(const de of U){const we={id:`${F}-${de}`,deskId:F,date:de,startDate:D.startDate,endDate:D.endDate,status:D.status,personName:D.personName,title:D.title,price:D.price,currency:D.currency||u,createdAt:new Date().toISOString()};M.push(we)}await me.bulkUpdateBookings(M),O.invalidateQueries({queryKey:["desk-bookings"]}),O.invalidateQueries({queryKey:["desk-stats"]}),O.invalidateQueries({queryKey:["next-dates"]});const ae=D.status==="assigned"?"assigned (paid)":"booked",ne=U.length,Ie=Dt[D.currency];C({title:"Desk Booking Created",description:`${D.personName} ${ae} for ${ne} day${ne>1?"s":""} - ${Ie}${D.price} total`})},[c,S,C,O]),be=g.useCallback(async D=>{var ae,ne,Ie,de,we,De;if(!c)return;const{deskId:F,date:U}=c,M={id:`${F}-${U}`,deskId:F,date:U,startDate:((ae=c.booking)==null?void 0:ae.startDate)||U,endDate:((ne=c.booking)==null?void 0:ne.endDate)||U,status:"assigned",personName:D,title:(Ie=c.booking)==null?void 0:Ie.title,price:(de=c.booking)==null?void 0:de.price,currency:((we=c.booking)==null?void 0:we.currency)||u||"BGN",createdAt:((De=c.booking)==null?void 0:De.createdAt)||new Date().toISOString()};await me.saveBooking(M),d(null),O.invalidateQueries({queryKey:["desk-bookings"]}),O.invalidateQueries({queryKey:["desk-stats"]}),O.invalidateQueries({queryKey:["next-dates"]}),C({title:"Person Assigned",description:`${D} assigned to desk`})},[c,S,C,u]),Be=g.useCallback(async(D,F,U,M)=>{const ae=pi(D,F),ne=[];for(const Ie of U)for(const de of ae)if(M==="available")await me.deleteBooking(Ie,de);else{const we={id:`${Ie}-${de}`,deskId:Ie,date:de,startDate:de,endDate:de,status:M,personName:void 0,title:void 0,price:void 0,currency:u||"BGN",createdAt:new Date().toISOString()};ne.push(we)}ne.length>0&&await me.bulkUpdateBookings(ne),O.invalidateQueries({queryKey:["desk-bookings"]}),O.invalidateQueries({queryKey:["desk-stats"]}),O.invalidateQueries({queryKey:["next-dates"]}),C({title:"Bulk Update Applied",description:`${U.length} desks updated for ${ae.length} days`})},[S,C,u]),vt=g.useCallback(async()=>{try{const D=await me.getAllBookings(),F={bookings:D,exportDate:new Date().toISOString(),version:"1.0",totalBookings:Object.keys(D).length},U=JSON.stringify(F,null,2),M=new Blob([U],{type:"application/json"}),ae=URL.createObjectURL(M),ne=document.createElement("a");ne.href=ae,ne.download=`desk-bookings-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne),URL.revokeObjectURL(ae),C({title:"Data Exported",description:`Successfully exported ${Object.keys(D).length} bookings`})}catch(D){console.error("Export error:",D),C({title:"Export Failed",description:"Failed to export data",variant:"destructive"})}},[C]);return o.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o.jsx("header",{className:"bg-white shadow-md border-b border-gray-200",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex justify-between items-center h-16",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"material-icon text-blue-600 text-2xl mr-3",children:"domain"}),o.jsx("h1",{className:"text-xl font-medium text-gray-900",children:"Coworking Desk Manager"})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(wg,{}),o.jsx(mg,{onCurrencyChange:h}),o.jsxs(se,{variant:"outline",onClick:()=>w(!0),className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"map"}),"Floor Plan"]}),o.jsxs(se,{variant:"outline",onClick:()=>x(!0),className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"date_range"}),"Set Availability"]}),o.jsxs(se,{onClick:vt,className:"bg-blue-600 hover:bg-blue-700",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"download"}),"Export"]}),o.jsxs(se,{onClick:()=>A(!0),className:"bg-purple-600 hover:bg-purple-700",children:[o.jsx("span",{className:"material-icon text-sm mr-2",children:"sync"}),"Migrate"]}),o.jsxs("div",{className:"flex items-center gap-2 ml-4 pl-4 border-l",children:[o.jsx("span",{className:"text-sm text-gray-600",children:r==null?void 0:r.email}),o.jsx(se,{onClick:()=>e(),variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:o.jsx(ed,{className:"h-4 w-4"})})]})]})]})})}),o.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsx(Le,{className:"mb-6",children:o.jsx(Ve,{className:"p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(se,{variant:"ghost",size:"sm",onClick:()=>{t==="week"?i(n-1):l(a-1)},className:"p-2 rounded-full",children:o.jsx("span",{className:"material-icon text-gray-600",children:"chevron_left"})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h2",{className:"text-lg font-medium text-gray-900",children:t==="week"?T:$}),o.jsx("p",{className:"text-sm text-gray-500",children:t==="week"?"Week View":"Month View"})]}),o.jsx(se,{variant:"ghost",size:"sm",onClick:()=>{t==="week"?i(n+1):l(a+1)},className:"p-2 rounded-full",children:o.jsx("span",{className:"material-icon text-gray-600",children:"chevron_right"})})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(se,{variant:t==="week"?"secondary":"ghost",size:"sm",onClick:()=>s("week"),className:t==="week"?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100",children:"Week"}),o.jsx(se,{variant:t==="month"?"secondary":"ghost",size:"sm",onClick:()=>s("month"),className:t==="month"?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100",children:"Month"})]})]})})}),o.jsx(Le,{className:"mb-6",children:o.jsxs(Ve,{className:"p-4",children:[o.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Status Legend"}),o.jsxs("div",{className:"flex flex-wrap gap-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-4 h-4 bg-green-600 rounded mr-2"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Available"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-4 h-4 bg-orange-600 rounded mr-2"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Booked"})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"w-4 h-4 bg-blue-100 border-2 border-blue-400 rounded mr-2"}),o.jsx("span",{className:"text-sm text-gray-700",children:"Person Assigned"})]})]})]})}),o.jsx(Le,{className:"overflow-hidden",children:o.jsx("div",{ref:V,className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-gray-50 border-b border-gray-200 sticky top-0 z-10",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32 sticky left-0 bg-gray-50 z-20",children:"Desk"}),le.map(D=>{const F=Re(D.dateString),U=ve(D.dateString);return o.jsx("th",{className:`px-3 py-3 text-center text-xs font-medium uppercase tracking-wider min-w-[120px] ${F?"bg-blue-50 text-blue-700 border-l-2 border-r-2 border-blue-300":U?"bg-gray-100 text-gray-400":"text-gray-500"}`,children:o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:`font-semibold ${F?"text-blue-900":U?"text-gray-400":"text-gray-900"}`,children:D.dayName}),o.jsx("span",{className:"text-xs",children:D.fullDate}),F&&o.jsx("span",{className:"text-xs font-medium text-blue-600 mt-1",children:"TODAY"}),U&&o.jsx("span",{className:"text-xs font-medium text-gray-400 mt-1",children:"WEEKEND"})]})},D.dateString)})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:it.map(D=>o.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap sticky left-0 bg-white z-10 border-r border-gray-200",children:o.jsxs("div",{className:"flex flex-col",children:[o.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["Desk ",D.number]}),o.jsxs("span",{className:`text-xs ${D.room===1?"text-blue-600":"text-pink-600"}`,children:["Room ",D.room]})]})}),le.map(F=>{const U=Re(F.dateString),M=ve(F.dateString);return o.jsx("td",{className:`px-2 py-3 text-center ${U?"bg-blue-50 border-l-2 border-r-2 border-blue-300":M?"bg-gray-100":""}`,children:o.jsx(lu,{deskId:D.id,date:F.dateString,booking:Ze(D.id,F.dateString),onClick:ae=>yt(D.id,F.dateString,ae),isWeekend:M})},F.dateString)})]},D.id))})]})})}),o.jsx(Le,{className:"mt-6",children:o.jsxs(Ve,{className:"p-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("span",{className:"material-icon text-green-600 text-xl mr-2",children:"event_available"}),o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Next Available Dates"})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:Z.length>0?Z.map(D=>{const F=new Date(D+"T00:00:00"),U=F.toLocaleDateString("en-US",{weekday:"short"}),M=F.toLocaleDateString("en-US",{month:"short"}),ae=F.getDate();return o.jsx("div",{className:"px-3 py-2 bg-green-50 border border-green-200 rounded-lg text-sm",children:o.jsxs("div",{className:"font-medium text-green-700",children:[U,", ",M," ",ae]})},D)}):o.jsx("span",{className:"text-sm text-gray-500",children:"No available dates found in the next 90 days"})})]}),ee.length>0&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("span",{className:"material-icon text-orange-600 text-xl mr-2",children:"event_busy"}),o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Next Booked Dates"})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:ee.map(({date:D,names:F})=>{const U=new Date(D+"T00:00:00"),M=U.toLocaleDateString("en-US",{weekday:"short"}),ae=U.toLocaleDateString("en-US",{month:"short"}),ne=U.getDate();return o.jsxs("div",{className:"px-3 py-2 bg-orange-50 border border-orange-200 rounded-lg text-sm",children:[o.jsxs("div",{className:"font-medium text-orange-700",children:[M,", ",ae," ",ne]}),o.jsx("div",{className:"text-xs text-orange-600 mt-1",children:F.join(", ")})]},D)})})]}),ie.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsxs("div",{className:"flex items-center mb-2",children:[o.jsx("span",{className:"material-icon text-red-600 text-xl mr-2",children:"alarm"}),o.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Assignments Expiring in Next 10 Days"})]}),o.jsx("div",{className:"flex flex-wrap gap-3",children:ie.map(({date:D,personName:F,deskNumber:U},M)=>{const ae=new Date(D+"T00:00:00"),ne=ae.toLocaleDateString("en-US",{weekday:"short"}),Ie=ae.toLocaleDateString("en-US",{month:"short"}),de=ae.getDate(),we=new Date().toISOString().split("T")[0]===D,De=new Date(Date.now()+864e5).toISOString().split("T")[0]===D;return o.jsxs("div",{className:"px-3 py-2 bg-red-50 border border-red-200 rounded-lg text-sm",children:[o.jsxs("div",{className:"font-medium text-red-700",children:[ne,", ",Ie," ",de,we&&o.jsx("span",{className:"ml-1 text-xs",children:"(Today)"}),De&&o.jsx("span",{className:"ml-1 text-xs",children:"(Tomorrow)"})]}),o.jsxs("div",{className:"text-xs text-red-600 mt-1",children:[o.jsx("div",{children:F}),o.jsxs("div",{className:"font-medium",children:["Desk ",U]})]})]},`${D}-${U}-${M}`)})})]})]})}),o.jsx("div",{className:"mt-6",children:o.jsx(bg,{})}),o.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx(Le,{children:o.jsx(Ve,{className:"p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("span",{className:"material-icon text-green-600 text-2xl",children:"check_circle"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Available"}),o.jsx("p",{className:"text-lg font-semibold text-green-600",children:P.available})]})]})})}),o.jsx(Le,{children:o.jsx(Ve,{className:"p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("span",{className:"material-icon text-orange-600 text-2xl",children:"event_busy"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Booked"}),o.jsx("p",{className:"text-lg font-semibold text-orange-600",children:P.booked})]})]})})}),o.jsx(Le,{children:o.jsx(Ve,{className:"p-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("span",{className:"material-icon text-blue-600 text-2xl",children:"person"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Assigned"}),o.jsx("p",{className:"text-lg font-semibold text-blue-600",children:P.assigned})]})]})})})]})]}),o.jsx(pu,{isOpen:b,onClose:()=>{v(!1),d(null)},booking:(c==null?void 0:c.booking)||null,deskId:(c==null?void 0:c.deskId)||"",date:(c==null?void 0:c.date)||"",currency:u,onSave:He}),o.jsx(hu,{isOpen:f,onClose:()=>{p(!1),d(null)},booking:(c==null?void 0:c.booking)||null,deskId:(c==null?void 0:c.deskId)||"",date:(c==null?void 0:c.date)||"",onSave:be}),o.jsx(Au,{isOpen:m,onClose:()=>x(!1),onApply:Be}),o.jsx(Pu,{isOpen:_,onClose:()=>w(!1)}),o.jsx(lg,{isOpen:k,onClose:()=>A(!1)})]})}function _g({onSuccess:r}){const[e,t]=g.useState(""),[s,n]=g.useState(""),[i,a]=g.useState(!1),[l,c]=g.useState(!1),[d,u]=g.useState(null),h=async f=>{f.preventDefault(),c(!0),u(null);try{const{data:p,error:b}=await Ht.auth.signInWithPassword({email:e,password:s});b?u(b.message):p.user&&(console.log("Logged in successfully:",p.user.email),r())}catch(p){u("An unexpected error occurred"),console.error("Login error:",p)}finally{c(!1)}};return o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:o.jsxs(Le,{className:"w-full max-w-md",children:[o.jsxs(or,{className:"space-y-1",children:[o.jsx("div",{className:"flex items-center justify-center mb-4",children:o.jsx("span",{className:"material-icon text-blue-600 text-4xl",children:"domain"})}),o.jsx(lr,{className:"text-2xl text-center",children:"Desk Planner"}),o.jsx(An,{className:"text-center",children:"Sign in to manage your coworking desk bookings"})]}),o.jsx(Ve,{children:o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),o.jsx(Ne,{id:"email",type:"email",placeholder:"your@email.com",value:e,onChange:f=>t(f.target.value),required:!0,disabled:l,autoFocus:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"password",className:"text-sm font-medium",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx(Ne,{id:"password",type:i?"text":"password",placeholder:"••••••••",value:s,onChange:f=>n(f.target.value),required:!0,disabled:l}),o.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",tabIndex:-1,children:i?o.jsx(Yc,{className:"h-4 w-4"}):o.jsx(Xc,{className:"h-4 w-4"})})]})]}),d&&o.jsx(Qs,{variant:"destructive",children:o.jsx(Js,{children:d})}),o.jsx(se,{type:"submit",className:"w-full",disabled:l||!e||!s,children:l?o.jsxs(o.Fragment,{children:[o.jsx(Ss,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Zc,{className:"mr-2 h-4 w-4"}),"Sign In"]})})]})})]})})}const qs=2,Ir="deskplanner_data_version";class kg{constructor(){this.metadataManager=new al}isMigrationNeeded(){return this.getCurrentDataVersion()<qs}getCurrentDataVersion(){try{const e=localStorage.getItem(Ir);return e?parseInt(e,10):0}catch{return 0}}setDataVersion(e){try{localStorage.setItem(Ir,e.toString())}catch(t){console.error("Failed to set data version:",t)}}async runMigrations(){const e=this.getCurrentDataVersion(),t={success:!0,message:"",migratedItems:[],errors:[]};console.log(`Starting migration from version ${e} to ${qs}`);try{e<1&&(t.migratedItems.push("Set initial data version to 1"),this.setDataVersion(1)),e<2&&(await this.migrateToVersion2(t),this.setDataVersion(2)),t.message=`Successfully migrated from version ${e} to ${qs}`,console.log(t.message)}catch(s){t.success=!1,t.message=`Migration failed: ${s instanceof Error?s.message:"Unknown error"}`,t.errors.push(t.message),console.error("Migration failed:",s)}return t}async migrateToVersion2(e){console.log("Migrating to version 2: Adding sync metadata system");const t=this.getExistingBookingsData(),s=this.getExistingSettingsData();if(t||s){if(this.metadataManager.getLocalMetadata()||(this.metadataManager.updateLocalMetadata({lastLocalUpdate:new Date().toISOString(),lastCloudUpdate:new Date(0).toISOString(),dataVersion:1}),e.migratedItems.push("Created initial sync metadata"),console.log("Created initial sync metadata for existing data")),t){const i=Object.keys(t).length;e.migratedItems.push(`Found ${i} existing bookings`),console.log(`Found ${i} existing bookings - metadata initialized`)}s&&(e.migratedItems.push("Found existing app settings"),console.log("Found existing app settings - metadata initialized"))}else this.metadataManager.updateLocalMetadata({lastLocalUpdate:new Date().toISOString(),lastCloudUpdate:new Date().toISOString(),dataVersion:1}),e.migratedItems.push("Initialized sync metadata for new installation"),console.log("No existing data found - initialized clean sync metadata")}getExistingBookingsData(){try{const e=localStorage.getItem("coworking-bookings"),t=localStorage.getItem("deskBookings");return e?JSON.parse(e):t?JSON.parse(t):null}catch(e){return console.error("Error reading existing bookings data:",e),null}}getExistingSettingsData(){try{const e=localStorage.getItem("coworking-settings");return e?JSON.parse(e):null}catch(e){return console.error("Error reading existing settings data:",e),null}}getMigrationStatus(){const e=this.getCurrentDataVersion(),t=this.getExistingBookingsData(),s=this.getExistingSettingsData();return{currentVersion:e,targetVersion:qs,needsMigration:this.isMigrationNeeded(),hasExistingData:!!(t||s)}}resetMigrationData(){try{localStorage.removeItem(Ir),this.metadataManager.reset(),console.log("Migration data reset successfully")}catch(e){console.error("Error resetting migration data:",e)}}}const Fi=new kg;function Sg({onComplete:r,children:e}){var l;const[t,s]=g.useState({isChecking:!0,needsMigration:!1,isRunning:!1,completed:!1,error:null,result:null});g.useEffect(()=>{n()},[]);const n=async()=>{try{console.log("Checking if localStorage migration is needed...");const c=Fi.getMigrationStatus();if(console.log("Migration status:",c),s(d=>({...d,isChecking:!1,needsMigration:c.needsMigration})),c.needsMigration){console.log("Migration needed, starting migration..."),s(u=>({...u,isRunning:!0}));const d=await Fi.runMigrations();console.log("Migration result:",d),d.success?(s(u=>({...u,isRunning:!1,completed:!0,result:d})),setTimeout(()=>{r()},2e3)):s(u=>({...u,isRunning:!1,error:d.message,result:d}))}else console.log("No migration needed"),r()}catch(c){console.error("Migration check/run failed:",c),s(d=>({...d,isChecking:!1,isRunning:!1,error:c instanceof Error?c.message:"Unknown migration error"}))}},i=()=>{s({isChecking:!0,needsMigration:!1,isRunning:!1,completed:!1,error:null,result:null}),n()},a=()=>{console.log("Skipping migration - continuing with app startup"),r()};return!t.isChecking&&!t.needsMigration&&!t.error?o.jsx(o.Fragment,{children:e}):o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full mx-4",children:o.jsxs("div",{className:"text-center",children:[t.isChecking&&o.jsxs(o.Fragment,{children:[o.jsx(Ss,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Checking Data Version"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Verifying your data compatibility..."})]}),t.isRunning&&o.jsxs(o.Fragment,{children:[o.jsx(Ss,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upgrading Data"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Please wait while we update your data to the latest format..."})]}),t.completed&&((l=t.result)==null?void 0:l.success)&&o.jsxs(o.Fragment,{children:[o.jsx(Wc,{className:"h-8 w-8 text-green-600 mx-auto mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Upgrade Complete"}),o.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Your data has been successfully updated!"}),t.result.migratedItems.length>0&&o.jsxs("div",{className:"bg-green-50 rounded-lg p-3 mb-4",children:[o.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Migration Details:"}),o.jsx("ul",{className:"text-xs text-green-700 text-left space-y-1",children:t.result.migratedItems.map((c,d)=>o.jsxs("li",{children:["• ",c]},d))})]})]}),t.error&&o.jsxs(o.Fragment,{children:[o.jsx(Nn,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),o.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Migration Error"}),o.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"There was a problem updating your data format."}),o.jsx("div",{className:"bg-red-50 rounded-lg p-3 mb-4",children:o.jsx("p",{className:"text-sm text-red-800",children:t.error})}),o.jsxs("div",{className:"flex gap-3 justify-center",children:[o.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700",children:"Retry Migration"}),o.jsx("button",{onClick:a,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-400",children:"Skip & Continue"})]})]})]})})})}function jg(){const{user:r,loading:e}=ll(),[t,s]=g.useState(!1);return e?o.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Ss,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t?o.jsx(Ui,{}):o.jsx(Sg,{onComplete:()=>s(!0),children:o.jsx(Ui,{})}):o.jsx(_g,{onSuccess:()=>window.location.reload()})}function Eg(){return o.jsx(sc,{client:yc,children:o.jsx(xg,{children:o.jsxs(ru,{children:[o.jsx(Md,{}),o.jsx(jg,{})]})})})}da(document.getElementById("root")).render(o.jsx(Eg,{}));
